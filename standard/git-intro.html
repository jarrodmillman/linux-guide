<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Git introduction &mdash; RCSDS 0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="RCSDS 0.1 documentation" href="../index.html" />
    <link rel="up" title="Core Topics" href="index.html" />
    <link rel="next" title="Advanced Bash" href="bash-advanced.html" />
    <link rel="prev" title="Course introduction" href="course-intro.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="git-introduction">
<h1><a class="toc-backref" href="#id8">Git introduction</a><a class="headerlink" href="#git-introduction" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#git-introduction" id="id8">Git introduction</a><ul>
<li><a class="reference internal" href="#what-is-version-control" id="id9">What is version control?</a></li>
<li><a class="reference internal" href="#core-git-concepts" id="id10">Core Git concepts</a></li>
<li><a class="reference internal" href="#stage-i-local-single-user-linear-workflow" id="id11">Stage I: Local, single-user, linear workflow</a><ul>
<li><a class="reference internal" href="#git-init-create-an-empty-repository" id="id12"><code class="docutils literal"><span class="pre">git</span> <span class="pre">init</span></code>: create an empty repository</a></li>
<li><a class="reference internal" href="#git-add-adding-content-to-the-repository" id="id13"><code class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></code>: adding content to the repository</a></li>
<li><a class="reference internal" href="#git-commit-permanently-record-our-changes-in-git-s-database" id="id14"><code class="docutils literal"><span class="pre">git</span> <span class="pre">commit</span></code>: permanently record our changes in git&#8217;s database</a></li>
<li><a class="reference internal" href="#git-log-what-has-been-committed-so-far" id="id15"><code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span></code>: what has been committed so far</a></li>
<li><a class="reference internal" href="#git-diff-what-have-i-changed" id="id16"><code class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></code>: what have I changed?</a></li>
<li><a class="reference internal" href="#the-cycle-of-git-virtue-work-add-commit" id="id17">The cycle of git virtue: work, add, commit, ...</a></li>
<li><a class="reference internal" href="#git-log-revisited" id="id18"><code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span></code> revisited</a></li>
<li><a class="reference internal" href="#git-mv-and-rm-moving-and-removing-files" id="id19"><code class="docutils literal"><span class="pre">git</span> <span class="pre">mv</span></code> and <code class="docutils literal"><span class="pre">rm</span></code>: moving and removing files</a></li>
<li><a class="reference internal" href="#exercise" id="id20">Exercise</a></li>
</ul>
</li>
<li><a class="reference internal" href="#stage-ii-local-user-branching" id="id21">Stage II: Local user, branching</a></li>
<li><a class="reference internal" href="#stage-iii-using-remotes-as-a-single-user" id="id22">Stage III: Using remotes as a single user</a></li>
<li><a class="reference internal" href="#an-important-aside-conflict-management" id="id23">An important aside: conflict management</a></li>
<li><a class="reference internal" href="#learning-git" id="id24">Learning Git</a></li>
</ul>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The content of these slides was adapted from Fernando Perez&#8217; <a class="reference external" href="https://github.com/fperez/reprosw/blob/master/Version%20Control.ipynb">Lecture notes
(in IPython Notebook format) on Reproducible Science And Modern Scientific
Software</a>.</p>
</div>
<div class="section" id="what-is-version-control">
<h2><a class="toc-backref" href="#id9">What is version control?</a><a class="headerlink" href="#what-is-version-control" title="Permalink to this headline">¶</a></h2>
<p>As a statistician, scientist, or engineer, you will work on projects that
include code, data, and text.  For trivially small and short-lived projects,
it may suffice to keep track of the various files mentally.  As the size
and duration of your project grows, you will eventually need to adopt
a system to track everything.</p>
<p>Consider the following example:</p>
<div class="highlight-python"><div class="highlight"><pre>[jarrod@t430u ~]$ tree proj1
proj1
├── code
│   ├── analysis.py
│   ├── eda.py
│   └── preprocess.py
├── data
│   └── blob.dat
├── figs
│   └── diagram.png
├── paper
│   ├── Makefile
│   ├── report.bib
│   └── report.tex
└── slides
    └── presentation.md

5 directories, 9 files
</pre></div>
</div>
<p>Above I&#8217;ve displayed the directory tree for a project. Now suppose that I have
an idea about an alternative analysis to the one currently implemented in
<code class="docutils literal"><span class="pre">proj1/code/analysis.py</span></code>.  I could manually backup the current analysis
script doing something like <code class="docutils literal"><span class="pre">cp</span> <span class="pre">analysis.py</span> <span class="pre">analysis.py.orig</span></code>.  And then
start implementing the new analysis in <code class="docutils literal"><span class="pre">analysis.py</span></code>.  While I am still
trying to debug my new analysis script, my advisor suggests a third alternative
approach, so now I create a third version <code class="docutils literal"><span class="pre">analysis-advisor.py</span></code>.  The new
analysis methods each require that I conduct different preprocessing
steps, so now I create the following new files: <code class="docutils literal"><span class="pre">preprocess-new.py</span></code> and
<code class="docutils literal"><span class="pre">preprocess-advisor.py</span></code>.  Now I just need to remember that
<code class="docutils literal"><span class="pre">preprocess-new.py</span></code> goes with <code class="docutils literal"><span class="pre">analysis.py</span></code>, <code class="docutils literal"><span class="pre">preprocess.py</span></code> goes with
<code class="docutils literal"><span class="pre">analysis.py.orig</span></code>, and <code class="docutils literal"><span class="pre">preprocess-advisor.py</span></code> goes with
<code class="docutils literal"><span class="pre">analysis-advisor.py</span></code>.</p>
<p>It is easy to further complicate this example.  For instance, what if you are
working on this project with several colleagues.  Each member will want their
own copy of the project and you will need a mechanism to share the files with
one another.  You might consider sharing the project using something like
Dropbox.  However, this will require care as it can be difficult to determine
which changes will be synced when two people try editing the same file at the
same time.</p>
<p>Instead of manually trying to keep track of the changes you&#8217;ve made to code,
data, and documents as indicated above, version control software helps you
automate and manage this process. This has several benefits:</p>
<ul class="simple">
<li>allowing you to easily go back to earlier versions;</li>
<li>allowing you to have multiple version you can switch between;</li>
<li>allowing you to easily separate tentative new directions into different
branches of work, which you can later discard or merge back into
your main line of development;</li>
<li>allowing you to share work easily without worrying about conflicts; and</li>
<li>providing built-in backup.</li>
</ul>
<p>To see how this works, we will now consider the basic operation of a popular
and powerful version control system (VCS) called Git.  First, we will need to
develop some basic vocabulary needed to discuss how Git works.  Then we will
see how to use Git locally as a single-user using a linear workflow.  We will
then see how to use branches rather than following a simple linear workflow.
Finally, we will discuss using remotes instead of just working locally.
Multi-user use will be covered in another tutorial.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">VCS come in two main architectures: client-server (e.g., CVS, Subversion)
and distributed (e.g., Mercurial, <strong>Git</strong>).  In the client-server
architecture, there is one master repository and everyone working
on the repositor has their own minimal local copy of the master
repository.  In the distributed model, every repository is a complete
repository and there are mechanisms for incorporating changes
from remote repositories into a local repository.</p>
</div>
</div>
<div class="section" id="core-git-concepts">
<h2><a class="toc-backref" href="#id10">Core Git concepts</a><a class="headerlink" href="#core-git-concepts" title="Permalink to this headline">¶</a></h2>
<p>A <strong>commit</strong> is a <strong>snapshot</strong> of an entire directory tree at a given point in
time, some metadata (e.g., reference to previous commits, authors name), and an
identifier (this is called a hash and will be discussed below).  Returning to
the above example, you would make a <strong>commit</strong> corresponding to the original
state of the directory tree, which I listed.  Committing the directory tree
as listed above will allow us to return to this exact state later.</p>
<div class="figure" id="id1">
<a class="reference internal image-reference" href="../_images/commit_anatomy.png"><img alt="Credit: ProGit book, by Scott Chacon, CC License." src="../_images/commit_anatomy.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">Here is a schematic representation of a commit.  The commit, which I
refer to as 98ca9.., has some metadata (i.e., author name and committer
name) as well as a pointer to the entire directory tree.</span></p>
<div class="legend">
Credit: ProGit book, by Scott Chacon, CC License.</div>
</div>
<p>A <strong>repository</strong> is a group of <strong>linked</strong> commits, which form a directed
acyclic graph (DAG), as well as a set of references to specific commits (we
refer to these references to commits as heads).  As part of the metadata of
each commit, we include references to 0 or more parent commits.  The initial
commit of each repository has 0 parents.  Each subsequent commit is proceeded
by 1 or more commits.</p>
<div class="figure" id="id2">
<a class="reference internal image-reference" href="../_images/threecommits.png"><img alt="Credit: ProGit book, by Scott Chacon, CC License." src="../_images/threecommits.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">This is a schematic representation of three commits in a linear
workflow.  The first commit 98ca9.. has no parents and Snapshot
A contains all the files and directory structure that was in
working tree when the project was started.  Additional files
were added or changed and a new commit 34ac2.. was made containing
all the files and directories corresponding to the new state
of the working tree.  This new commit 34ac2.. has one parent
98ca9.., which it points to.  Continuing in this manner,
a new commit f30ab.. is made on top of the second commit
34ac2...</span></p>
<div class="legend">
Credit: ProGit book, by Scott Chacon, CC License.</div>
</div>
<p>Again returning to our example, the initial <strong>commit</strong> might correspond to the
the original state of the directory tree, which I listed above.  Now when you
begin implementing your new analysis method, you don&#8217;t need to make any copies
of the previous files (i.e., there is no need to execute <code class="docutils literal"><span class="pre">cp</span> <span class="pre">analysis.py</span>
<span class="pre">analysis.py.orig</span></code>).  Since they are already committed, you can always access
the original state of the repository by checking out the original commit.  To
proceed you would simply make the necessary edits to the files in your
directory tree and then when you are satisfied with your changes you make a new
commit.  This new commit will correspond to a snapshot of the entire directory
tree with all the edits you&#8217;ve made to it since the original commit.  To keep
track of the history of the project, the new commit will include a reference to
the original commit as its parent.  Now when your advisor suggests the
alternative analysis, you could checkout the original commit, implement the new
method, and commit your changes including a reference to the original commit as
its sole parent.</p>
<p>Finally, we need to understand how Git keeps track of commits. To reference a
commit, Git uses a <strong>hash</strong>.  Hashing provides a way to have a fixed-length
identifier for a given set of information, such as a file or set of files. The
identifier is not guaranteed to be unique, but if the number of items is small,
it will almost always be unique.</p>
<p>To make this concrete, consider the following toy &#8220;implementation&#8221; in R:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">library</span><span class="p">(</span><span class="s">&#39;digest&#39;</span><span class="p">)</span>

<span class="c"># first commit</span>
<span class="n">data1</span> <span class="o">&lt;-</span> <span class="s">&#39;This is the start of my paper.&#39;</span>
<span class="n">meta1</span> <span class="o">&lt;-</span> <span class="s">&#39;date: 8/20/15&#39;</span>
<span class="n">hash1</span> <span class="o">&lt;-</span> <span class="n">digest</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">meta1</span><span class="p">),</span> <span class="n">algo</span><span class="o">=</span><span class="s">&quot;sha1&quot;</span><span class="p">)</span>
<span class="n">cat</span><span class="p">(</span><span class="s">&#39;Hash:&#39;</span><span class="p">,</span> <span class="n">hash1</span><span class="p">)</span>

<span class="c"># second commit, linked to the first</span>
<span class="n">data2</span> <span class="o">&lt;-</span> <span class="s">&#39;Some more text in my paper...&#39;</span>
<span class="n">meta2</span> <span class="o">&lt;-</span> <span class="s">&#39;date: 8/20/15&#39;</span>
<span class="c"># Note we add the parent hash here!</span>
<span class="n">hash2</span> <span class="o">&lt;-</span> <span class="n">digest</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="n">meta2</span><span class="p">,</span> <span class="n">hash1</span><span class="p">),</span> <span class="n">algo</span><span class="o">=</span><span class="s">&quot;sha1&quot;</span><span class="p">)</span>
<span class="n">cat</span><span class="p">(</span><span class="s">&#39;Hash:&#39;</span><span class="p">,</span> <span class="n">hash2</span><span class="p">)</span>
</pre></div>
</div>
<p>And here it is in Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sha</span>

<span class="c"># first commit</span>
<span class="n">data1</span> <span class="o">=</span> <span class="s">&#39;This is the start of my paper.&#39;</span>
<span class="n">meta1</span> <span class="o">=</span> <span class="s">&#39;date: 8/20/15&#39;</span>
<span class="n">hash1</span> <span class="o">=</span> <span class="n">sha</span><span class="o">.</span><span class="n">sha</span><span class="p">(</span><span class="n">data1</span> <span class="o">+</span> <span class="n">meta1</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&#39;Hash:&#39;</span><span class="p">,</span> <span class="n">hash1</span>

<span class="c"># second commit, linked to the first</span>
<span class="n">data2</span> <span class="o">=</span> <span class="s">&#39;Some more text in my paper...&#39;</span>
<span class="n">meta2</span> <span class="o">=</span> <span class="s">&#39;date: 8/20/15&#39;</span>
<span class="c"># Note we add the parent hash here!</span>
<span class="n">hash2</span> <span class="o">=</span> <span class="n">sha</span><span class="o">.</span><span class="n">sha</span><span class="p">(</span><span class="n">data2</span> <span class="o">+</span> <span class="n">meta2</span> <span class="o">+</span> <span class="n">hash1</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&#39;Hash:&#39;</span><span class="p">,</span> <span class="n">hash2</span>
</pre></div>
</div>
<p>Now that we have developed some basic vocabulary, let&#8217;s see start using Git.
To start with we will use Git in the simplest way possible&#8212;as a single-user
working linearly with no remotes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you haven&#8217;t done so already, you will want to configure Git before
proceeding.  You will want to do something like the following from
your Bash shell:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git config --global user.name &quot;Jarrod Millman&quot;
$ git config --global user.email &quot;millman@berkeley.edu&quot;
$ git config --global core.editor /usr/bin/jed
</pre></div>
</div>
<p class="last">The first two lines tell Git who you are (obviously you should use
your own name and address rather than mine).  The final command
tells Git which text editor you wish to use.  You should use whatever
text editor you prefer.  For instance, I use <code class="docutils literal"><span class="pre">/usr/bin/vim</span></code>.</p>
</div>
</div>
<div class="section" id="stage-i-local-single-user-linear-workflow">
<h2><a class="toc-backref" href="#id11">Stage I: Local, single-user, linear workflow</a><a class="headerlink" href="#stage-i-local-single-user-linear-workflow" title="Permalink to this headline">¶</a></h2>
<p>From a Bash shell, type <code class="docutils literal"><span class="pre">git</span></code> (or <code class="docutils literal"><span class="pre">git</span> <span class="pre">help</span></code>) to see a list of the &#8216;core&#8217;
commands, which will look something like this:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git
usage: git &lt;command&gt; [&lt;args&gt;]

The most commonly used git commands are:
   add        Add file contents to the index
   config     Get and set options
   clone      Clone a repository
   commit     Record changes to the repository
   init       Create an empty Git repository
   log        Show commit logs
   push       Update remote
   status     Show the working tree status
</pre></div>
</div>
<p>You will see more commands than this, but these are the ones we cover in the
remainder of this tutorial.</p>
<div class="section" id="git-init-create-an-empty-repository">
<h3><a class="toc-backref" href="#id12"><code class="docutils literal"><span class="pre">git</span> <span class="pre">init</span></code>: create an empty repository</a><a class="headerlink" href="#git-init-create-an-empty-repository" title="Permalink to this headline">¶</a></h3>
<p>First create an empty repository using the <code class="docutils literal"><span class="pre">init</span></code> command:</p>
<div class="highlight-python"><div class="highlight"><pre>cd ~/src
git init demo
</pre></div>
</div>
<p>Let&#8217;s look at what git did:</p>
<div class="highlight-python"><div class="highlight"><pre>cd demo
ls -la
ls -l .git
</pre></div>
</div>
</div>
<div class="section" id="git-add-adding-content-to-the-repository">
<h3><a class="toc-backref" href="#id13"><code class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></code>: adding content to the repository</a><a class="headerlink" href="#git-add-adding-content-to-the-repository" title="Permalink to this headline">¶</a></h3>
<p>Now let&#8217;s edit our first file in the test directory with a text editor.  I&#8217;m
doing it programatically here for automation purposes, but you&#8217;d normally be
editing by hand:</p>
<div class="highlight-python"><div class="highlight"><pre>cd ~/src/demo
echo &quot;My first bit of text&quot; &gt; file1.txt
</pre></div>
</div>
<p>Now we can tell git about this new file using the <code class="docutils literal"><span class="pre">add</span></code> command:</p>
<div class="highlight-python"><div class="highlight"><pre>git add file1.txt
</pre></div>
</div>
<p>We can now ask git about what happened with <code class="docutils literal"><span class="pre">status</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>git status
</pre></div>
</div>
</div>
<div class="section" id="git-commit-permanently-record-our-changes-in-git-s-database">
<h3><a class="toc-backref" href="#id14"><code class="docutils literal"><span class="pre">git</span> <span class="pre">commit</span></code>: permanently record our changes in git&#8217;s database</a><a class="headerlink" href="#git-commit-permanently-record-our-changes-in-git-s-database" title="Permalink to this headline">¶</a></h3>
<p>Now we are ready to commit our changes:</p>
<div class="highlight-python"><div class="highlight"><pre>git commit -m &quot;This is our first commit&quot;
</pre></div>
</div>
<p>In the commit above, we used the <code class="docutils literal"><span class="pre">-m</span></code> flag to specify a message at the
command line. If we don&#8217;t do that, git will open the editor we specified
in our configuration above and require that we enter a message. By
default, git refuses to record changes that don&#8217;t have a message to go
along with them (though you can obviously &#8216;cheat&#8217; by using an empty or
meaningless string: git only tries to facilitate best practices, it&#8217;s
not your nanny).</p>
</div>
<div class="section" id="git-log-what-has-been-committed-so-far">
<h3><a class="toc-backref" href="#id15"><code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span></code>: what has been committed so far</a><a class="headerlink" href="#git-log-what-has-been-committed-so-far" title="Permalink to this headline">¶</a></h3>
<p>To see a log of the commits:</p>
<div class="highlight-python"><div class="highlight"><pre>git log
</pre></div>
</div>
</div>
<div class="section" id="git-diff-what-have-i-changed">
<h3><a class="toc-backref" href="#id16"><code class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></code>: what have I changed?</a><a class="headerlink" href="#git-diff-what-have-i-changed" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s do a little bit more work. Again, in practice you&#8217;ll be editing
the files by hand, here we do it via shell commands for the sake of
automation (and therefore the reproducibility of this tutorial!)</p>
<div class="highlight-python"><div class="highlight"><pre>echo &quot;And now some more text...&quot; &gt;&gt; file1.txt
</pre></div>
</div>
<p>And now we can ask git what is different:</p>
<div class="highlight-python"><div class="highlight"><pre>git diff
</pre></div>
</div>
</div>
<div class="section" id="the-cycle-of-git-virtue-work-add-commit">
<h3><a class="toc-backref" href="#id17">The cycle of git virtue: work, add, commit, ...</a><a class="headerlink" href="#the-cycle-of-git-virtue-work-add-commit" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>echo &quot;Great progress ...&quot; &gt;&gt; file1.txt
git add file1.txt
git commit -m &quot;Great progress on this matter.&quot;
</pre></div>
</div>
</div>
<div class="section" id="git-log-revisited">
<h3><a class="toc-backref" href="#id18"><code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span></code> revisited</a><a class="headerlink" href="#git-log-revisited" title="Permalink to this headline">¶</a></h3>
<p>First, let&#8217;s see what the log shows us now:</p>
<div class="highlight-python"><div class="highlight"><pre>git log
</pre></div>
</div>
<p>Sometimes it&#8217;s handy to see a very summarized version of the log:</p>
<div class="highlight-python"><div class="highlight"><pre>git log --oneline --topo-order --graph
</pre></div>
</div>
<p>Git supports <em>aliases:</em> new names given to command combinations. Let&#8217;s
make this handy shortlog an alias, so we only have to type <code class="docutils literal"><span class="pre">git</span> <span class="pre">slog</span></code>
and see this compact log:</p>
<div class="highlight-python"><div class="highlight"><pre># We create our alias (this saves it in git&#39;s permanent configuration file):
git config --global alias.slog &quot;log --oneline --topo-order --graph&quot;
# And now we can use it git slog
</pre></div>
</div>
</div>
<div class="section" id="git-mv-and-rm-moving-and-removing-files">
<h3><a class="toc-backref" href="#id19"><code class="docutils literal"><span class="pre">git</span> <span class="pre">mv</span></code> and <code class="docutils literal"><span class="pre">rm</span></code>: moving and removing files</a><a class="headerlink" href="#git-mv-and-rm-moving-and-removing-files" title="Permalink to this headline">¶</a></h3>
<p>While <code class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></code> is used to add files to the list git tracks, we must
also tell it if we want their names to change or for it to stop tracking
them. In familiar Unix fashion, the <code class="docutils literal"><span class="pre">mv</span></code> and <code class="docutils literal"><span class="pre">rm</span></code> git commands do
precisely this:</p>
<div class="highlight-python"><div class="highlight"><pre>git mv file1.txt file-newname.txt
git status
</pre></div>
</div>
<p>Note that these changes must be committed too, to become permanent! In
git&#8217;s world, until something hasn&#8217;t been committed, it isn&#8217;t permanently
recorded anywhere:</p>
<div class="highlight-python"><div class="highlight"><pre>git commit -m &quot;I like this new name better&quot;
git slog
</pre></div>
</div>
<p>And <code class="docutils literal"><span class="pre">git</span> <span class="pre">rm</span></code> works in a similar fashion.</p>
</div>
<div class="section" id="exercise">
<h3><a class="toc-backref" href="#id20">Exercise</a><a class="headerlink" href="#exercise" title="Permalink to this headline">¶</a></h3>
<p>Add a new file <code class="docutils literal"><span class="pre">file2.txt</span></code>, commit it, make some changes to it, commit
them again, and then remove it (and don&#8217;t forget to commit this last
step!).</p>
</div>
</div>
<div class="section" id="stage-ii-local-user-branching">
<h2><a class="toc-backref" href="#id21">Stage II: Local user, branching</a><a class="headerlink" href="#stage-ii-local-user-branching" title="Permalink to this headline">¶</a></h2>
<p>Before understanding what a Git <strong>branch</strong> is, we need to revist the idea
of a <strong>head</strong>.  As discussed Git labels every commit with cryptographic
signature called a hash.  These hashs can be considered to uniquely identify
every commit and are used to verify that the contents of the commit and
history of the commit are correct.  While this is extremely important, it
is unlikely that you will remember these hashes.  This is where heads come
into play.  A head is an easy to remember label (e.g., <code class="docutils literal"><span class="pre">HEAD</span></code>, <code class="docutils literal"><span class="pre">master</span></code>,
<code class="docutils literal"><span class="pre">feature1</span></code>) that references a commit.</p>
<div class="figure" id="id3">
<a class="reference internal image-reference" href="../_images/masterbranch.png"><img alt="Credit: ProGit book, by Scott Chacon, CC License." src="../_images/masterbranch.png" style="width: 90%;" /></a>
<p class="caption"><span class="caption-text">By default every repository has a head called <code class="docutils literal"><span class="pre">master</span></code>. In this
figure <code class="docutils literal"><span class="pre">master</span></code> refers to the commit whose has begins
<code class="docutils literal"><span class="pre">f30ab</span></code>.  This allows you to refer to the commit by the easy
to remember name <code class="docutils literal"><span class="pre">master</span></code> rather than <code class="docutils literal"><span class="pre">f30ab</span></code>.</span></p>
<div class="legend">
Credit: ProGit book, by Scott Chacon, CC License.</div>
</div>
<p>A repository can contain any number of heads.  At any point in time,
your current working directory will correspond to a specific commmit.
By convention, we refer to this commit with the name <code class="docutils literal"><span class="pre">HEAD</span></code> (note
the use of all capital letters to distinguish this from the generic
notion of head).</p>
<p>In Git, the notions of branch and head are essentially identical. Each
branch is associated with exactly one head and each head corresponds
to one branch.  However, we use the term head to refer exclusively
to a label on exactly one commit; while the term branch may also
sometimes be used to refer not only to the commit labeled by the
head but that commit and all the commits that proceed it in the
repository.</p>
<div class="figure" id="id4">
<a class="reference internal image-reference" href="../_images/HEAD_testing.png"><img alt="Credit: ProGit book, by Scott Chacon, CC License." src="../_images/HEAD_testing.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-text">In this example there are two heads or branches, <em>master</em> and <em>testing</em>,
and <em>testing</em> is the currently active branch since it&#8217;s what <em>HEAD</em> points
to.</span></p>
<div class="legend">
Credit: ProGit book, by Scott Chacon, CC License.</div>
</div>
<p>Once new commits are made on a branch, HEAD and the branch label move
with the new commits:</p>
<div class="figure" id="id5">
<a class="reference internal image-reference" href="../_images/branchcommit.png"><img alt="Credit: ProGit book, by Scott Chacon, CC License." src="../_images/branchcommit.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">In this example (notice that HEAD is not shown), the branch
master and iss53 share a common history up to commit C2.
However, the branch iss53 differs from master as it
has the additional commit C3.</span></p>
<div class="legend">
Credit: ProGit book, by Scott Chacon, CC License.</div>
</div>
<p>This allows the history of both branches to diverge:</p>
<div class="figure" id="id6">
<a class="reference internal image-reference" href="../_images/mergescenario.png"><img alt="Credit: ProGit book, by Scott Chacon, CC License." src="../_images/mergescenario.png" style="width: 60%;" /></a>
<p class="caption"><span class="caption-text">Here both master and iss53 have a shared history up to
the commit C2.  However they both have commits that the
other lacks after their shared ancestor.</span></p>
<div class="legend">
Credit: ProGit book, by Scott Chacon, CC License.</div>
</div>
<p>But based on this graph structure, Git can compute the necessary information to
merge the divergent branches back and continue with a unified line of
development:</p>
<div class="figure" id="id7">
<a class="reference internal image-reference" href="../_images/mergeaftermath.png"><img alt="Credit: ProGit book, by Scott Chacon, CC License." src="../_images/mergeaftermath.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">Credit: ProGit book, by Scott Chacon, CC License.</span></p>
</div>
<p>Let&#8217;s now illustrate all of this with a concrete example. Let&#8217;s get our
bearings first:</p>
<div class="highlight-python"><div class="highlight"><pre>git status
ls
</pre></div>
</div>
<p>We are now going to try two different routes of development: on the
<code class="docutils literal"><span class="pre">master</span></code> branch we will add one file and on the <code class="docutils literal"><span class="pre">experiment</span></code> branch,
which we will create, we will add a different one. We will then merge
the experimental branch into <code class="docutils literal"><span class="pre">master</span></code>.</p>
<p>Create and work on an experimental branch:</p>
<div class="highlight-python"><div class="highlight"><pre>git branch experiment
git checkout experiment
echo &quot;Some crazy idea&quot; &gt; experiment.txt
git add experiment.txt
git commit -m &quot;Trying something new&quot;
git slog
</pre></div>
</div>
<p>Work on the master branch:</p>
<div class="highlight-python"><div class="highlight"><pre>git checkout master
git slog
echo &quot;Work goes on in master...&quot; &gt;&gt; file-newname.txt
git add file-newname.txt
git commit -m &quot;The mainline keeps moving&quot;
git slog
</pre></div>
</div>
<p>Now merge experimental branch:</p>
<div class="highlight-python"><div class="highlight"><pre>ls
git merge experiment
git slog
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>We&#8217;ve seen that Git has multiple ways for referring to a commit.</p>
<ol class="last arabic simple">
<li>Using the full hash, which you can find using <code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span></code></li>
<li>Using the first few characters of the hash (as long as there is no
ambiquity)</li>
<li>Using a head label (e.g., <code class="docutils literal"><span class="pre">HEAD</span></code> or <code class="docutils literal"><span class="pre">master</span></code>)</li>
<li>Relative to a specified commit (e.g., <code class="docutils literal"><span class="pre">HEAD^</span></code> is the parent of the
current head commit)</li>
</ol>
</div>
</div>
<div class="section" id="stage-iii-using-remotes-as-a-single-user">
<h2><a class="toc-backref" href="#id22">Stage III: Using remotes as a single user</a><a class="headerlink" href="#stage-iii-using-remotes-as-a-single-user" title="Permalink to this headline">¶</a></h2>
<p>We are now going to introduce the concept of a <em>remote repository</em>: a
pointer to another copy of the repository that lives on a different
location. This can be simply a different path on the filesystem or a
server on the internet.</p>
<p>For this discussion, we&#8217;ll be using remotes hosted on the
<a class="reference external" href="http://github.com">GitHub.com</a> service, but you can equally use
other services like <a class="reference external" href="http://bitbucket.org">BitBucket</a> or
<a class="reference external" href="http://gitorious.org">Gitorious</a> as well as host your own.</p>
<div class="highlight-python"><div class="highlight"><pre>git remote -v
</pre></div>
</div>
<p>Since the above cell didn&#8217;t produce any output after the
<code class="docutils literal"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">-v</span></code> call, it means we have no remote repositories
configured. We will now proceed to do so.</p>
<p>Once logged into GitHub, go to
the <a class="reference external" href="https://github.com/new">new repository page</a> and make a
repository called <code class="docutils literal"><span class="pre">test</span></code>. Do <strong>not</strong> check the box that says
<code class="docutils literal"><span class="pre">Initialize</span> <span class="pre">this</span> <span class="pre">repository</span> <span class="pre">with</span> <span class="pre">a</span> <span class="pre">README</span></code>, since we already have an
existing repository here. That option is useful when you&#8217;re starting
first at Github and don&#8217;t have a repo made already on a local computer.</p>
<p>We can now follow the instructions from the next page:</p>
<div class="highlight-python"><div class="highlight"><pre>git remote add origin git@github.com:jarrodmillman/test.git
git push -u origin master
</pre></div>
</div>
<p>Let&#8217;s see the remote situation again:</p>
<div class="highlight-python"><div class="highlight"><pre>git remote -v
</pre></div>
</div>
<p>We can now <a class="reference external" href="https://github.com/jarrodmillman/test">see this repository publicly on
github</a>.</p>
<p>Let&#8217;s see how this can be useful for backup and syncing work between two
different computers. I&#8217;ll simulate a 2nd computer by working in a
different directory...</p>
<div class="highlight-python"><div class="highlight"><pre>cd ~/src/
# Here I clone my &#39;test&#39; repo but with a different name, test2,
# to simulate a 2nd computer
git clone git@github.com:jarrodmillman/test.git test2
cd test2
pwd
git remote -v
</pre></div>
</div>
<p>Let&#8217;s now make some changes in one &#8216;computer&#8217; and synchronize them on
the second.</p>
<div class="highlight-python"><div class="highlight"><pre>cd ~/src/test2
# working on computer #2
echo &quot;More new content on my experiment&quot; &gt;&gt; experiment.txt
git add experiment.txt
git commit -m &quot;More work, on machine #2&quot;
</pre></div>
</div>
<p>Now we put this new work up on the github server so it&#8217;s available from
the internet:</p>
<div class="highlight-python"><div class="highlight"><pre># working on computer #2
git push
</pre></div>
</div>
<p>Now let&#8217;s fetch that work from machine #1:</p>
<div class="highlight-python"><div class="highlight"><pre>cd ~/src/demo
git pull
</pre></div>
</div>
</div>
<div class="section" id="an-important-aside-conflict-management">
<h2><a class="toc-backref" href="#id23">An important aside: conflict management</a><a class="headerlink" href="#an-important-aside-conflict-management" title="Permalink to this headline">¶</a></h2>
<p>While git is very good at merging, if two different branches modify the
same file in the same location, it simply can&#8217;t decide which change
should prevail. At that point, human intervention is necessary to make
the decision. Git will help you by marking the location in the file that
has a problem, but it&#8217;s up to you to resolve the conflict. Let&#8217;s see how
that works by intentionally creating a conflict.</p>
<p>We start by creating a branch and making a change to our experiment
file:</p>
<div class="highlight-python"><div class="highlight"><pre>git branch trouble
git checkout trouble
echo &quot;This is going to be a problem...&quot; &gt;&gt; experiment.txt
git add experiment.txt
git commit -m &quot;Changes in the trouble branch&quot;
</pre></div>
</div>
<p>And now we go back to the master branch, where we change the <em>same</em>
file:</p>
<div class="highlight-python"><div class="highlight"><pre>git checkout master
echo &quot;More work on the master branch...&quot; &gt;&gt; experiment.txt
git add experiment.txt
git commit -m &quot;Mainline work&quot;``
</pre></div>
</div>
<p>So now let&#8217;s see what happens if we try to merge the <code class="docutils literal"><span class="pre">trouble</span></code> branch
into <code class="docutils literal"><span class="pre">master</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>git merge trouble
</pre></div>
</div>
<p>Let&#8217;s see what git has put into our file:</p>
<div class="highlight-python"><div class="highlight"><pre>cat experiment.txt
</pre></div>
</div>
<p>At this point, we go into the file with a text editor, decide which
changes to keep, and make a new commit that records our decision. To
automate my edits, I use the <code class="docutils literal"><span class="pre">sed</span></code> command:</p>
<div class="highlight-python"><div class="highlight"><pre>sed -i &#39;/^&lt;/d&#39; experiment.txt
sed -i &#39;/^&gt;/d&#39; experiment.txt
sed -i &#39;/^=/d&#39; experiment.txt
</pre></div>
</div>
<p>I&#8217;ve now made the edits, in this case I decided that both pieces of text
were useful, so I just accepted both additions.</p>
<div class="highlight-python"><div class="highlight"><pre>cat experiment.txt
</pre></div>
</div>
<p>Let&#8217;s then make our new commit:</p>
<div class="highlight-python"><div class="highlight"><pre>git add experiment.txt
git commit -m &quot;Completed merge of trouble, fixing conflicts along the way&quot;
git slog
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">While it&#8217;s a good idea to understand the basics of fixing merge
conflicts by hand, in some cases you may find the use of an automated
tool useful. Git supports multiple <a class="reference external" href="https://www.kernel.org/pub/software/scm/git/docs/git-mergetool.html">merge
tools</a>:
a merge tool is a piece of software that conforms to a basic interface
and knows how to merge two files into a new one. Since these are
typically graphical tools, there are various to choose from for the
different operating systems, and as long as they obey a basic command
structure, git can work with any of them.</p>
</div>
</div>
<div class="section" id="learning-git">
<h2><a class="toc-backref" href="#id24">Learning Git</a><a class="headerlink" href="#learning-git" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://nyuccl.org/pages/GitTutorial/">Git for Scientists: A
Tutorial</a></li>
<li><a class="reference external" href="http://matthew-brett.github.io/pydagogue/gitwash_build.html">Gitwash: workflow for scientific Python
projects</a></li>
<li><a class="reference external" href="http://pcottle.github.io/learnGitBranching/">Git branching demo</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">RCSDS</a></h1>



<p class="blurb">Fall 2015</p>




<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Core Topics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="course-intro.html">Course introduction</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Git introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="bash-advanced.html">Advanced Bash</a></li>
<li class="toctree-l2"><a class="reference internal" href="fmri-intro.html">Statistical analysis of fMRI data</a></li>
<li class="toctree-l2"><a class="reference internal" href="python.html">Python introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="numpy.html">Scientific computing with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="git-advanced.html">Collaborative workflow with Git</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../append/index.html">Appendices</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="http://www.jarrodmillman.com/stat159-fall2015/">Course home</a></li>
    
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
      &copy;2009-2015, K. Jarrod Millman.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
      |
      <a href="_sources/index.txt"
          rel="nofollow">Page source</a>
        <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution 4.0 International License</a>, except where indicated otherwise.
</small></p>
    </div>

  </body>
</html>