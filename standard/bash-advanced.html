<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Advanced Bash &mdash; RCSDS 0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="RCSDS 0.1 documentation" href="../index.html" />
    <link rel="up" title="Standard Topics" href="index.html" />
    <link rel="next" title="Statistical analysis of fMRI data" href="fmri-intro.html" />
    <link rel="prev" title="Git introduction" href="git-intro.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="advanced-bash">
<span id="bash-advanced"></span><h1><a class="toc-backref" href="#id1">Advanced Bash</a><a class="headerlink" href="#advanced-bash" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#advanced-bash" id="id1">Advanced Bash</a><ul>
<li><a class="reference internal" href="#the-interactive-shell" id="id2">The Interactive Shell</a><ul>
<li><a class="reference internal" href="#logging-in" id="id3">Logging In</a></li>
<li><a class="reference internal" href="#variables" id="id4">Variables</a></li>
<li><a class="reference internal" href="#commands" id="id5">Commands</a></li>
<li><a class="reference internal" href="#shortcuts" id="id6">Shortcuts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#basic-file-management" id="id7">Basic File Management</a><ul>
<li><a class="reference internal" href="#files" id="id8">Files</a></li>
<li><a class="reference internal" href="#navigation" id="id9">Navigation</a></li>
<li><a class="reference internal" href="#manipulation" id="id10">Manipulation</a></li>
<li><a class="reference internal" href="#filename-globbing" id="id11">Filename Globbing</a></li>
<li><a class="reference internal" href="#quoting" id="id12">Quoting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-manipulation" id="id13">Data Manipulation</a><ul>
<li><a class="reference internal" href="#finding-files" id="id14">Finding Files</a></li>
<li><a class="reference internal" href="#regular-expressions" id="id15">Regular Expressions</a></li>
<li><a class="reference internal" href="#ed-and-grep" id="id16"><strong>ed</strong> and <strong>grep</strong></a></li>
<li><a class="reference internal" href="#sed-and-awk" id="id17"><strong>sed</strong> and <strong>awk</strong></a></li>
<li><a class="reference internal" href="#perl" id="id18"><strong>perl</strong></a></li>
</ul>
</li>
<li><a class="reference internal" href="#streams-pipes-and-redirects" id="id19">Streams, Pipes, and Redirects</a><ul>
<li><a class="reference internal" href="#default-file-descriptors" id="id20">Default File Descriptors</a></li>
<li><a class="reference internal" href="#io-redirection" id="id21">IO Redirection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-monitoring-and-killing-processes" id="id22">Creating, Monitoring, and Killing Processes</a><ul>
<li><a class="reference internal" href="#processes" id="id23">Processes</a></li>
<li><a class="reference internal" href="#monitoring-processes" id="id24">Monitoring Processes</a></li>
<li><a class="reference internal" href="#signaling-processes" id="id25">Signaling Processes</a></li>
<li><a class="reference internal" href="#shell-job-control" id="id26">Shell Job Control</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shell-programming" id="id27">Shell programming</a><ul>
<li><a class="reference internal" href="#functions" id="id28">Functions</a></li>
<li><a class="reference internal" href="#if-then-else" id="id29">If/then/else</a></li>
<li><a class="reference internal" href="#for-loops" id="id30">For loops</a></li>
<li><a class="reference internal" href="#how-much-shell-scripting-should-i-learn" id="id31">How much shell scripting should I learn?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#documentation-tools" id="id32">Documentation tools</a></li>
</ul>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This material assumes that you have already worked through
the &#8220;Basics of UNIX&#8221; tutorial and screencast here:
<a class="reference external" href="http://statistics.berkeley.edu/computing/training/tutorials">http://statistics.berkeley.edu/computing/training/tutorials</a></p>
</div>
<div class="section" id="the-interactive-shell">
<h2><a class="toc-backref" href="#id2">The Interactive Shell</a><a class="headerlink" href="#the-interactive-shell" title="Permalink to this headline">¶</a></h2>
<p>In order to be of interest to the user, a computer must have a <em>human interface
component</em>. A CLI is a text based interface.  The user is given a <em>prompt</em> to
indicate the computers reeadiness to accept <em>input</em>. The user enters or types a
<em>command</em> on the line (or lines) following the prompt. The computer,
consequently, executes or interprets the command and prompts the user when its
finished.</p>
<p>The program which prompts the user and interprets the user&#8217;s commands is called
a <em>shell</em>.  When you are working in a terminal window (i.e., a window with the
command line interface), you’re interacting with a shell.</p>
<p>There are multiple shells (<em>sh</em>, <em>bash</em>, <em>csh</em>, <em>tcsh</em>, <em>zsh</em>, <em>fish</em>).  Since
We&#8217;ll assume usage of <em>bash</em>, as this is the default for Mac OS X, the BCE VM,
the SCF machines and most Linux distributions.  However, the basic ideas are
applicable to any of UNIX&#8217;s shells.</p>
<p>As you will see the shell is an amazingly powerful programming environment.
From it you can interactively control almost any aspect of the OS and more
importantly you can automate it. As you will see, <strong>bash</strong> has a very extensive
set of capabalities intended to make both interactive as well as automated
control simple, effective, and customizable.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>It can be difficult to distinguish what is shell-specific and
what is just part of UNIX. Some of the material here is not
bash-specific but general to UNIX.</p>
<p class="last">Reference: Newham and Rosenblatt, Learning the bash Shell, 2nd ed.</p>
</div>
<div class="section" id="logging-in">
<h3><a class="toc-backref" href="#id3">Logging In</a><a class="headerlink" href="#logging-in" title="Permalink to this headline">¶</a></h3>
<p><strong>Useful Commands</strong></p>
<ul class="simple">
<li><a class="reference internal" href="../commands/su.html#command-su"><span>su</span></a> &#8211;&nbsp;run a shell with substitute user and group IDs</li>
<li><a class="reference internal" href="../commands/sudo.html#command-sudo"><span>sudo</span></a> &#8211;&nbsp;execute a command as another user</li>
</ul>
<p>We assume that you already are able to access a terminal from the BCE VM.
However, it is occassionally useful to operate as a different user.  For
instance, you may need to change file permissions or install software.
As you work through this tutorial, we will see examples of this.</p>
</div>
<div class="section" id="variables">
<h3><a class="toc-backref" href="#id4">Variables</a><a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h3>
<p><strong>Useful Commands</strong></p>
<ul class="simple">
<li><a class="reference internal" href="../commands/echo.html#command-echo"><span>echo</span></a> &#8211;&nbsp;display a line of text</li>
<li><a class="reference internal" href="../commands/which.html#command-which"><span>which</span></a> &#8211;&nbsp;shows the full path of (shell) commands.</li>
<li><a class="reference internal" href="../commands/man.html#command-man"><span>man</span></a> &#8211;&nbsp;format and display the on-line manual pages</li>
<li><code class="docutils literal"><span class="pre">printenv</span></code> &#8211; print all or part of environment</li>
</ul>
<p><strong>Standard Variables</strong></p>
<ul class="simple">
<li>SHELL, HOME, PS1, PATH</li>
</ul>
<p>Much of how bash behaves can be customized through the use of variables,
which consists of names that have values assigned to them.  To access
the value currently assigned to a variable, you can prepend the name
with the dollar sign ($).  To print the value you can use the <code class="docutils literal"><span class="pre">echo</span></code>
command.</p>
<ol class="arabic">
<li><div class="first line-block">
<div class="line">What is my default shell?</div>
<div class="line"><code class="docutils literal"><span class="pre">$</span> <span class="pre">echo</span> <span class="pre">$SHELL</span></code></div>
</div>
</li>
<li><div class="first line-block">
<div class="line">To change to bash on a one-time basis:</div>
<div class="line"><code class="docutils literal"><span class="pre">$</span> <span class="pre">bash</span></code></div>
</div>
</li>
<li><div class="first line-block">
<div class="line">To make it your default:</div>
<div class="line"><code class="docutils literal"><span class="pre">$</span> <span class="pre">chsh</span> <span class="pre">/bin/bash</span></code></div>
<div class="line"><em>/bin/bash</em> should be whatever the path to the bash shell is, which
you can figure out using <code class="docutils literal"><span class="pre">which</span> <span class="pre">bash</span></code></div>
</div>
</li>
</ol>
<p>To see how this works, let&#8217;s work with the</p>
<p><strong>Example 2-1. PS1: Prompt String 1</strong></p>
<div class="highlight-python"><div class="highlight"><pre>[user1@local1 src]$ echo $PS1
[\u@\h \W]\$
</pre></div>
</div>
<p><strong>Example 2-2. Changing PS1</strong></p>
<div class="highlight-python"><div class="highlight"><pre>[user1@local1 src]$ PS1=$
$ bash
[user1@local1 src]$ export PS1=$
$ bash
$
</pre></div>
</div>
<p>Shell commands can be saved in a file (with extension <em>.sh</em>) and this
file can be executed as if it were a program. To run a shell script
called <em>file.sh</em>, you would type <code class="docutils literal"><span class="pre">./file.sh</span></code>. Note that if you just
typed`` file.sh``, the operating system will generally have trouble
finding the script and recognizing that it is executable. To be sure
that the operating system knows what shell to use to interpret the
script, the first line of the script should be <code class="docutils literal"><span class="pre">#!/bin/bash</span></code> (in the
case that you’re using the bash shell). Also, <em>file.sh</em> would need to be
executable (i.e., to have the ’x’ flag set).</p>
<p><strong>Example 2-3. PATH</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ echo $PATH
/bin:/usr/bin:/usr/X11R6/bin:/usr/local/bin
</pre></div>
</div>
<p><strong>Example 2-4. Finding **echo</strong> with <strong>which**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ which echo
/bin/echo
</pre></div>
</div>
<p>We can define shell variables that will help us when writing shell
scripts. Here’s an example of defining a variable:</p>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">myDir=~/stat243-fall-2014/units</span></code></div>
<div class="line">The shell may not like it if you leave any spaces around the = sign.
To see the value of a variable we need to precede it by <em>$</em>:</div>
</div>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">echo</span> <span class="pre">$myDir</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">cd</span> <span class="pre">$myDir</span></code></p>
<p>You can also enclose the variable name in curly brackets, which comes in
handy when we’re embedding a variable within a line of code to make sure
the shell knows where the variable name ends:</p>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">echo</span> <span class="pre">${myDir}</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">touch</span> <span class="pre">${myDir}/tmp.txt</span></code></p>
<p>There are also special shell variables called environment variables that
help to control the shell’s behavior. These are generally named in all
caps. Type <code class="docutils literal"><span class="pre">env</span></code> to see them. You can create your own environment
variable as follows:</p>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">export</span> <span class="pre">myDir=~/stat243-fall-2014/units</span></code></div>
<div class="line">The <em>export</em> command ensures that other shells created by the current
shell (for example, to run a program) will inherit the variable.
Without the export command, any shell variables that are set will only
be modified within the current shell. More generally, if one wants a
variable to always be accessible, one would include the definition of
the variable with an <em>export</em> command in your <em>.bashrc</em> file.</div>
</div>
<p>Here’s an example of an environment variable that controls what your
prompt looks like. We can modify it so that it puts the username,
hostname, and pwd in your prompt. This is handy so you know what machine
you’re on and where in the filesystem you are. [Note that on the VM, PS1
is already set in a very similar manner.]</p>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">echo</span> <span class="pre">$PS1</span></code></p>
<dl class="docutils">
<dt>::</dt>
<dd>&gt; export <a class="reference external" href="mailto:PS1=u&#37;&#52;&#48;h">PS1=u<span>&#64;</span>h</a>:w&gt;</dd>
</dl>
<p>For me, this is one of the most important things to put in my
<em>.bashrc</em> file. The <strong>\</strong> syntax tells bash what to put in the prompt
string: <em>u</em> for username, <em>h</em> for hostname, and <em>w</em> for working
directory.</p>
</div>
<div class="section" id="commands">
<h3><a class="toc-backref" href="#id5">Commands</a><a class="headerlink" href="#commands" title="Permalink to this headline">¶</a></h3>
<p><strong>Useful Commands</strong></p>
<ul class="simple">
<li><a class="reference internal" href="../commands/ls.html#command-ls"><span>ls</span></a> &#8211;&nbsp;list directory contents</li>
</ul>
<p>While each command has its own syntax, there are some rules usually
followed. Generally, a command line consists of 4 things:</p>
<ol class="arabic simple">
<li>command</li>
<li>command options</li>
<li>arguments</li>
<li>line acceptance</li>
</ol>
<p><strong>Example 2-6. General Command Syntax</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ ls --all -l
total 44
drwxr-xr-x    2 user1   group1          4096 Feb 26 19:06 .
drwx------   63 user1   group1         12288 Feb 26 19:04 ..
-rw-r--r--    1 user1   group1         28251 Feb 26 19:01 manual.xml

$ ls -a -l
total 44
drwxr-xr-x    2 user1   group1          4096 Feb 26 19:06 .
drwx------   63 user1   group1         12288 Feb 26 19:04 ..
-rw-r--r--    1 user1   group1         28251 Feb 26 19:01 manual.xml

$ ls -al
total 44
drwxr-xr-x    2 user1   group1          4096 Feb 26 19:06 .
drwx------   63 user1   group1         12288 Feb 26 19:04 ..
-rw-r--r--    1 user1   group1         28251 Feb 26 19:01 manual.xml

$ ls -al manual.xml
-rw-r--r--    1 user1   group1         28251 Feb 26 19:01 manual.xml
</pre></div>
</div>
<div class="section" id="tab-completion">
<h4>Tab completion<a class="headerlink" href="#tab-completion" title="Permalink to this headline">¶</a></h4>
<p>When working in the shell, it is often unnecessary to type out an entire
command or file name, because of a feature known as tab completion. When
you are entering a command or filename in the shell, you can, at any
time, hit the tab key, and the shell will try to figure out how to
complete the name of the command or filename you are typing. If there is
only one command in the search path and you’re using tab completion with
the first token of a line, then the shell will display its value and the
cursor will be one space past the completed name. If there are multiple
commands that match the partial name, the shell will display as much as
it can. In this case, hitting tab twice will display a list of choices,
and redisplay the partial command line for further editing. Similar
behavior with regard to filenames occurs when tab completion is used on
anything other than the first token of a command.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that R does tab completion for objects (including functions) and
filenames.</p>
</div>
</div>
<div class="section" id="command-history-and-editing">
<h4>Command History and Editing<a class="headerlink" href="#command-history-and-editing" title="Permalink to this headline">¶</a></h4>
<p><strong>Useful Commands</strong></p>
<ul class="simple">
<li><a class="reference internal" href="../commands/history.html#command-history"><span>history</span></a> &#8211;&nbsp;lists the history of entered commands</li>
</ul>
<p><strong>Example 2-7. Examing your command history with **history**</strong></p>
<p>By using the up and down arrows, you can scroll through commands that
you have entered previously. So if you want to rerun the same command,
or fix a typo in a command you entered, just scroll up to it and hit
enter to run it or edit the line and then hit enter.</p>
<div class="highlight-python"><div class="highlight"><pre>$ history
  1    echo $PS1
  2    PS1=$
  3    bash
  4    export PS1=$
  5    bash
  6    echo $PATH
  7    which echo
  8    ls --all -l
  9    ls -a -l
  10   ls -al
  11   ls -al manual.xml
</pre></div>
</div>
<p><strong>Example 2-8. Where is the **history</strong> information kept?**</p>
<div class="highlight-python"><div class="highlight"><pre>$ echo $HISTFILE
/group1/user1/.bash_history
$ echo $HISTSIZE
1000
</pre></div>
</div>
<p>You can also rerun previous commands as follows:</p>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">!-n</span> <span class="pre">#</span> <span class="pre">runs</span> <span class="pre">the</span> <span class="pre">``\</span> <span class="pre">``n</span></code><code class="docutils literal"><span class="pre">th</span> <span class="pre">previous</span> <span class="pre">command</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">!gi</span> <span class="pre">#</span> <span class="pre">runs</span> <span class="pre">the</span> <span class="pre">last</span> <span class="pre">command</span> <span class="pre">that</span> <span class="pre">started</span> <span class="pre">with</span> <span class="pre">’gi’</span></code></p>
<p><strong>Table 2-1. Command History Expansion</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Designator</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">!!</span></code></td>
<td>Last command</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">!n</span></code></td>
<td>Command numbered <em>n</em> in the history</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">!-n</span></code></td>
<td>Command <em>n</em> previous</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">!string</span></code></td>
<td>Last command starting with <em>string</em></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">!?string</span></code></td>
<td>Last command containing <em>string</em></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">^string1^string2</span></code></td>
<td>Execute the previous command with <em>string2</em>
substituted for <em>string1</em></td>
</tr>
</tbody>
</table>
<p>If you’re not sure what command you’re going to recall, you can append
<code class="docutils literal"><span class="pre">:p</span></code> at the end of the text you type to do the recall, and the result
will be printed, but not executed. For example:</p>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">!gi:p</span></code></div>
<div class="line">You can then use the up arrow key to bring back that statement for
editing or execution.</div>
</div>
<p>You can also search for commands by doing <code class="docutils literal"><span class="pre">C-r</span></code> and typing a string of
characters to search for in the search history. You can hit return to
submit, <code class="docutils literal"><span class="pre">C-c</span></code> to get out, or <code class="docutils literal"><span class="pre">ESC</span></code> to put the result on the regular
command line for editing.</p>
</div>
<div class="section" id="command-completion-and-substitution">
<h4>Command Completion and Substitution<a class="headerlink" href="#command-completion-and-substitution" title="Permalink to this headline">¶</a></h4>
<p><strong>Example 2-9. Command Substitution</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ ls -l echo
ls: echo: No such file or directory
$ ls -l $(which echo)
-rwxr-xr-x    1 root     root        11704 Mar  7  2002 /bin/echo
</pre></div>
</div>
</div>
</div>
<div class="section" id="shortcuts">
<h3><a class="toc-backref" href="#id6">Shortcuts</a><a class="headerlink" href="#shortcuts" title="Permalink to this headline">¶</a></h3>
<p><strong>Useful Commands</strong></p>
<ul class="simple">
<li><a class="reference internal" href="../commands/clear.html#command-clear"><span>clear</span></a> &#8211;&nbsp;clear the terminal screen</li>
</ul>
<p>Aliases &#8211; command shortcuts</p>
<p>Aliases allow you to use an abbreviation for a command, to create new
functionality or to insure that certain options are always used when you
call an existing command. For example, I’m lazy and would rather type
<code class="docutils literal"><span class="pre">q</span></code> instead of <code class="docutils literal"><span class="pre">exit</span></code> to terminate a shell window. You could create
the alias as follow</p>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">alias</span> <span class="pre">q=exit</span></code></div>
<div class="line">As another example, suppose you find the <em>-F</em> option of <em>ls</em> (which
displays <strong>*/*</strong> after directories, <strong>***</strong> after executable files
and <strong>*&#64;*</strong> after links) to be very useful. The command</div>
</div>
<dl class="docutils">
<dt>::</dt>
<dd>&gt; alias ls=ls -F</dd>
</dl>
<p>will insure that the <em>-F</em> option will be used whenever you use <em>ls</em>.
If you need to use the unaliased version of something for which you’ve
created an alias, precede the name with a backslash (<strong>*\*</strong>). For
example, to use the normal version of <em>ls</em> after you’ve created the
alias described above, just type</p>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">\ls</span></code></p>
<p>The real power of aliases is only achieved when they are automatically
set up whenever you log in to the computer or open a new shell window.
To achieve that goal with aliases (or any other bash shell commands),
simply insert the commands in the file <em>.bashrc</em> in your home directory.
See the <em>example.bashrc</em> file in the repository for some of what’s in my
<em>.bashrc</em> file.</p>
<p>Keyboard shorcuts</p>
<p>Note that you can use emacs-like control sequences (<code class="docutils literal"><span class="pre">C-a</span></code>, <code class="docutils literal"><span class="pre">C-e</span></code>,
<code class="docutils literal"><span class="pre">C-k</span></code>) to navigate and delete characters, just as you can at the
prompt in the shell usually.</p>
<p><strong>Table 2-2. Keyboard Shortcuts</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key Strokes</th>
<th class="head">Descriptions</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>Ctrl-a</em></td>
<td>begin of line</td>
</tr>
<tr class="row-odd"><td><em>Ctrl-e</em></td>
<td>End of file</td>
</tr>
<tr class="row-even"><td><em>Ctrl-k</em></td>
<td>Delete line from cursor forward</td>
</tr>
<tr class="row-odd"><td><em>Ctrl-d</em></td>
<td>EOF; exit</td>
</tr>
<tr class="row-even"><td><em>Ctrl-c</em></td>
<td>Interrupt current command</td>
</tr>
<tr class="row-odd"><td><em>Ctrl-z</em></td>
<td>Suspend current command</td>
</tr>
<tr class="row-even"><td><em>Ctrl-l</em></td>
<td>Clear screen</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="basic-file-management">
<h2><a class="toc-backref" href="#id7">Basic File Management</a><a class="headerlink" href="#basic-file-management" title="Permalink to this headline">¶</a></h2>
<div class="section" id="files">
<h3><a class="toc-backref" href="#id8">Files</a><a class="headerlink" href="#files" title="Permalink to this headline">¶</a></h3>
<p><strong>Useful Commands</strong></p>
<ul>
<li><p class="first"><a class="reference internal" href="../commands/stat.html#command-stat"><span>stat</span></a> &#8211;&nbsp;display file or filesystem status</p>
</li>
<li><p class="first"><a class="reference internal" href="../commands/file.html#command-file"><span>file</span></a> &#8211;&nbsp; determine file type</p>
</li>
<li><dl class="first docutils">
<dt><a class="reference internal" href="../commands/type.html#command-type"><span>type</span></a> &#8211;&nbsp;For each <em>name</em>, indicate how it would be</dt>
<dd><p class="first last">interpreted if used as a command name.</p>
</dd>
</dl>
</li>
<li><p class="first"><a class="reference internal" href="../commands/ln.html#command-ln"><span>ln</span></a> &#8211;&nbsp;make links between files</p>
</li>
<li><p class="first"><a class="reference internal" href="../commands/chmod.html#command-chmod"><span>chmod</span></a> &#8211;&nbsp;change file access permissions</p>
</li>
</ul>
<p>A file typically consist of these attributes:</p>
<ul class="simple">
<li>Name.</li>
<li>Type.</li>
<li>Location.</li>
<li>Size.</li>
<li>Protection.</li>
<li>Time, date, and user identification.</li>
</ul>
<p>Examples: chmod -c -v -R</p>
<p><strong>Example 2-10. Examining File Attributes with **ls</strong>, <strong>stat</strong>, and <strong>file**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ ls -l
total 32
drwxr-xr-x    3 user1   group1          4096 Mar  3 09:58 db2html-dir
-rw-r--r--    1 user1   group1         48958 Mar  3 09:58 manual.xml

$ stat manual.xml
  File: &quot;manual.xml&quot;
  Size: 48958           Blocks: 96         IO Block: 4096   Regular File
Device: 7h/7d   Inode: 2204387     Links: 1
Access: (0644/-rw-r--r--)  Uid: (  503/  user1)   Gid: (  551/     group1)
Access: Mon Mar  3 09:58:44 2003
Modify: Mon Mar  3 09:58:43 2003
Change: Mon Mar  3 09:58:43 2003

$ file manual.xml
manual.xml: exported SGML document text
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last"><strong>Be aware of Magic:</strong>
The <em>file</em> command relies on many sources
of information to determine what a file contains. The easiest part
to explain is <em>magic</em>. Specifically, the <em>file</em> command examines
the content of the file and compares it with information found in
the <em>/usr/share/magic/</em> directory.</p>
</div>
<p><strong>Example 2-11. Creating Symbolic Links with **ln**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ ln -s db2html-dir unix_users_guide
$ ls -l
total 32
drwxr-xr-x    3 user1   group1          4096 Mar  3 09:58 db2html-dir
-rw-r--r--    1 user1   group1         48958 Mar  3 09:58 manual.xml
lrwxrwxrwx    1 user1   group1            11 Mar  3 10:06 unix_users_guide -&gt; db2html-dir
</pre></div>
</div>
<p><strong>Example 2-12. Changing File Attributes with **chmod**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ chmod g+w manual.xml
$ ls -l manual.xml
-rw-rw-r--    1 user1   group1         49889 Mar  3 10:09 manual.xml
</pre></div>
</div>
</div>
<div class="section" id="navigation">
<h3><a class="toc-backref" href="#id9">Navigation</a><a class="headerlink" href="#navigation" title="Permalink to this headline">¶</a></h3>
<p><strong>Useful Commands</strong></p>
<ul>
<li><dl class="first docutils">
<dt><a class="reference internal" href="../commands/cd.html#command-cd"><span>cd</span></a> &#8211;&nbsp;Change the current working directory to</dt>
<dd><p class="first last"><em>directory</em>.</p>
</dd>
</dl>
</li>
<li><p class="first"><a class="reference internal" href="../commands/pwd.html#command-pwd"><span>pwd</span></a> &#8211;&nbsp;print name of current/working directory</p>
</li>
</ul>
<p><strong>Example 2-13. Moving Around the Filesystem with **cd</strong>, ~,and <strong>pwd**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ cd ~
$ pwd
/home/user1
</pre></div>
</div>
</div>
<div class="section" id="manipulation">
<h3><a class="toc-backref" href="#id10">Manipulation</a><a class="headerlink" href="#manipulation" title="Permalink to this headline">¶</a></h3>
<p><strong>Useful Commands</strong></p>
<ul class="simple">
<li><a class="reference internal" href="../commands/cat.html#command-cat"><span>cat</span></a> &#8211;&nbsp;concatenate files and print on the standard output</li>
<li><a class="reference internal" href="../commands/cp.html#command-cp"><span>cp</span></a>&#8211;&nbsp;copy files and directories</li>
<li><a class="reference internal" href="../commands/diff.html#command-diff"><span>diff</span></a>&#8211;&nbsp;find differences between two files</li>
<li><a class="reference internal" href="../commands/head.html#command-head"><span>head</span></a> &#8211;&nbsp;output the first part of files</li>
<li><a class="reference internal" href="../commands/less.html#command-less"><span>less</span></a> &#8211;&nbsp;opposite of more</li>
<li><a class="reference internal" href="../commands/more.html#command-more"><span>more</span></a> &#8211;&nbsp; file perusal filter for crt viewing</li>
<li><a class="reference internal" href="../commands/mv.html#command-mv"><span>mv</span></a> &#8211;&nbsp;move (rename) files</li>
<li><a class="reference internal" href="../commands/paste.html#command-paste"><span>paste</span></a> &#8211;&nbsp;merge lines of files</li>
<li><a class="reference internal" href="../commands/rm.html#command-rm"><span>rm</span></a> &#8211;&nbsp;remove files or directories</li>
<li><a class="reference internal" href="../commands/rmdir.html#command-rmdir"><span>rmdir</span></a> &#8211;&nbsp;remove empty directories</li>
<li><a class="reference internal" href="../commands/sort.html#command-sort"><span>sort</span></a> &#8211;&nbsp;sort lines of text files.</li>
<li><a class="reference internal" href="../commands/split.html#command-split"><span>split</span></a> &#8211;&nbsp;split a file into pieces</li>
<li><a class="reference internal" href="../commands/tac.html#command-tac"><span>tac</span></a> &#8211;&nbsp;concatenate and print files in reverse</li>
<li><a class="reference internal" href="../commands/tail.html#command-tail"><span>tail</span></a> &#8211;&nbsp;output the last part of files</li>
<li><a class="reference internal" href="../commands/touch.html#command-touch"><span>touch</span></a> &#8211;&nbsp;change file timestamps</li>
<li><a class="reference internal" href="../commands/uniq.html#command-uniq"><span>uniq</span></a> &#8211;&nbsp; remove duplicate lines from a sorted file</li>
</ul>
<p>Examples: touch, cp, mv, rename...</p>
<div class="highlight-python"><div class="highlight"><pre>$ ls
dest.txt
$ cp dest.txt{,.bak}
$ ls
dest.txt  dest.txt.bak
</pre></div>
</div>
<p><strong>Example 2-14. Manipulating Files with **touch</strong>, <strong>rm</strong>, and <strong>rmdir**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ touch index.rst; rm _build; rmdir _build
rm: `_build&#39; is a directory
rmdir: `_build&#39;: Directory not empty

$ rm -Rf _build
$ ls -l
total 56
-rw-rw-r--    1 user1   group1         50939 Mar  3 10:23 index.rst
lrwxrwxrwx    1 user1   group1            11 Mar  3 10:06 doc -&gt; db2html-dir
</pre></div>
</div>
</div>
<div class="section" id="filename-globbing">
<h3><a class="toc-backref" href="#id11">Filename Globbing</a><a class="headerlink" href="#filename-globbing" title="Permalink to this headline">¶</a></h3>
<p>The shell will expand certain special characters to match patterns of
file names, before passing those filenames on to a program. Note that
the programs themselves don’t know anything about wildcards; it is the
shell that does the expansion, so that programs don’t see the wildcards.
Table 1 shows some of the special characters that the shell uses for
expansion:</p>
<p><strong>Table 2-3. File-Naming Wildcards</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Wildcard</th>
<th class="head">Function</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">*</span></code></td>
<td>Match zero or more characters.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">?</span></code></td>
<td>Match exactly one character.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">[characters]</span></code></td>
<td><dl class="first last docutils">
<dt>Match any single character from among <em>characters</em></dt>
<dd>listed between brackets.</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">[!characters]</span></code></td>
<td><dl class="first last docutils">
<dt>Match any single character other than <em>characters</em></dt>
<dd>listed between brackets.</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">[a-z]</span></code></td>
<td><dl class="first last docutils">
<dt>Match any single character from among the range of</dt>
<dd>characters listed between brackets.</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">[!a-z]</span></code></td>
<td><dl class="first last docutils">
<dt>Match any single character from among the characters</dt>
<dd>not in the range listed between brackets</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">{frag1,</span> <span class="pre">frag2,</span> <span class="pre">frag3,...}</span></code></td>
<td><dl class="first last docutils">
<dt>Brace expansion: create strings frag1, frag2, and</dt>
<dd>frag3, etc.</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p>Here are some examples of using wildcards:</p>
<ul>
<li><p class="first">List all files ending with a digit:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; ls *[0-9]
</pre></div>
</div>
</li>
<li><p class="first">Make a copy of <em>filename</em> as <em>filename.old</em>:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; cp filename{,.old}
</pre></div>
</div>
</li>
<li><p class="first">Remove all files beginning with <em>a</em> or <em>z</em>:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; rm [az]*
</pre></div>
</div>
</li>
<li><p class="first">List all the R code files with a variety of suffixes:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; ls *.{r,q,R}
</pre></div>
</div>
</li>
</ul>
<p>The <em>echo</em> command can be used to verify that a wildcard expansion will
do what you think it will:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; echo cp filename{,.old} # returns cp filename filename.old
</pre></div>
</div>
<p>If you want to suppress the special meaning of a wildcard in a shell
command, precede it with a backslash (<strong>*\*</strong>). Note that this is a
general rule of thumb in many similar situations when a character has a
special meaning but you just want to treat it as a character.</p>
<p><strong>Example 2-15. Using brace expansion</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ echo file{one,two,three}
fileone filetwo filethree
</pre></div>
</div>
</div>
<div class="section" id="quoting">
<h3><a class="toc-backref" href="#id12">Quoting</a><a class="headerlink" href="#quoting" title="Permalink to this headline">¶</a></h3>
<p><strong>Table 2-4. Quotes</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Types of Quoting</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">'</span> <span class="pre">'</span></code></td>
<td>hard quote - no substitution allowed</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">&quot;</span> <span class="pre">&quot;</span></code></td>
<td>soft quote - allow substitution</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">`</span> <span class="pre">`</span></code></td>
<td>execute immediately</td>
</tr>
</tbody>
</table>
<p>Finally, a note about using single vs. double quotes in shell code. In
general, variables inside double quotes will be evaluated, but variables
not inside double quotes will not be:</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c">## My name is chris</span>
<span class="c">## My name is $name</span>
<span class="c">## He said, &quot;My name is chris.&quot;</span>
</pre></div>
</div>
<p>So we’ll generally use double quotes. We can always work with a literal
double quote by escaping it as seen above.</p>
</div>
</div>
<div class="section" id="data-manipulation">
<h2><a class="toc-backref" href="#id13">Data Manipulation</a><a class="headerlink" href="#data-manipulation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="finding-files">
<h3><a class="toc-backref" href="#id14">Finding Files</a><a class="headerlink" href="#finding-files" title="Permalink to this headline">¶</a></h3>
<p>Useful Contents</p>
<ul class="simple">
<li><a class="reference internal" href="../commands/find.html#command-find"><span>find</span></a> &#8211;&nbsp; search for files in a directory hierarchy</li>
</ul>
<p><strong>Example 4-1. **find**ing files by name, modification time, and type</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ find . -name &#39;*.txt&#39;        # find files named *.txt
$ find . mtime -2             # find files modified less than 2 days ago
$ find . type l               # find links
</pre></div>
</div>
</div>
<div class="section" id="regular-expressions">
<h3><a class="toc-backref" href="#id15">Regular Expressions</a><a class="headerlink" href="#regular-expressions" title="Permalink to this headline">¶</a></h3>
<p><strong>Table 4-1. Regular Expressions</strong></p>
<p>Category</p>
<p><strong>Position anchors</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operators</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>^</em></td>
<td>Match the beginning of a line.</td>
</tr>
<tr class="row-odd"><td><em>$</em></td>
<td>Match the end of a line.</td>
</tr>
</tbody>
</table>
<p><strong>Character sets</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operators</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>[abc]</em></td>
<td>Match any single character from from the listed characters</td>
</tr>
<tr class="row-odd"><td><em>[a-z]</em></td>
<td>Match any single character from the range of characters</td>
</tr>
<tr class="row-even"><td><em>[^abc]</em></td>
<td>Match any single character not among listed characters</td>
</tr>
<tr class="row-odd"><td><em>[^a-z]</em></td>
<td>Match any single character not among listed range of characters</td>
</tr>
<tr class="row-even"><td><em>\&lt; word\&gt;</em></td>
<td>Match <em>words</em> bounded by whitespace.</td>
</tr>
<tr class="row-odd"><td><em>.</em></td>
<td>Match any single character expcept a <em>newline</em></td>
</tr>
<tr class="row-even"><td><em>\</em></td>
<td>Turn off (escape) the special meaning of a metacharacter</td>
</tr>
</tbody>
</table>
<p><strong>Modifiers</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operators</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>*</em></td>
<td>Match zero or more of the character that precedes it.</td>
</tr>
<tr class="row-odd"><td><em>?</em></td>
<td>Match zero or one instace of the preceding <em>regex</em>.</td>
</tr>
<tr class="row-even"><td><em>+</em></td>
<td>Match one or more instances of the preceding <em>regex</em>.</td>
</tr>
<tr class="row-odd"><td><em>\{n,m\}</em></td>
<td>Match a range of occurrences of the single character or <em>regex</em>
that precedes this construct.</td>
</tr>
<tr class="row-even"><td><em>|</em></td>
<td>Match the character or expression to the left or right of the
vertical bar.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last"><strong>Globs vs. Regex:</strong>
Be sure you understand the difference between filename globbing (see
<a class="reference external" href="basic-file-management.html#FILENAMEGLOBS">the Section called *Filename Globbing* in Chapter 2</a>)
and regular expressions.</p>
</div>
</div>
<div class="section" id="ed-and-grep">
<h3><a class="toc-backref" href="#id16"><strong>ed</strong> and <strong>grep</strong></a><a class="headerlink" href="#ed-and-grep" title="Permalink to this headline">¶</a></h3>
<p>Useful Contents</p>
<ul class="simple">
<li><a class="reference internal" href="../commands/grep.html#command-grep"><span>grep</span></a> &#8211;&nbsp;print lines matching a pattern</li>
<li><a class="reference internal" href="../commands/tr.html#command-tr"><span>tr</span></a> &#8211;&nbsp;translate or delete characters</li>
</ul>
<p><strong>Example 4-2. Translating lowercase to UPPERCASE with **tr**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ echo &#39;user1&#39;  | tr &#39;a-z&#39; &#39;A-Z&#39;
USER1
</pre></div>
</div>
</div>
<div class="section" id="sed-and-awk">
<h3><a class="toc-backref" href="#id17"><strong>sed</strong> and <strong>awk</strong></a><a class="headerlink" href="#sed-and-awk" title="Permalink to this headline">¶</a></h3>
<p><strong>sed</strong> (stream editor) derives from <strong>ed</strong>.</p>
<p><strong>Example 4-3. Printing lines of text with **sed**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ sed -n &#39;1,9p&#39; file.txt       # prints out lines 1-9 of file.txt
$ sed -n &#39;/^#/p&#39; file.txt       # prints out lines starting with # of file.txt
</pre></div>
</div>
<p><strong>Example 4-4. Deleting lines of text with **sed**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ sed -e &#39;1,9d&#39; file.txt       # deletes lines 1-9 of file.txt
$ sed -e &#39;/^;/d&#39; -e &#39;/^$/d&#39; file.txt       # deletes lines
</pre></div>
</div>
<p><strong>Example 4-5. Text substitution with **sed**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ sed &#39;s/old_pattern/new_pattern/&#39; file.txt &gt; new_file.txt       # replaces only 1st instance in a line
$ sed &#39;s/old_pattern/new_pattern/g&#39; file.txt &gt; new_file.txt
</pre></div>
</div>
<p><strong>Example 4-6. Killing **mozilla</strong> with <strong>awk**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ ps
      PID TTY          TIME CMD
17043 pts/2    00:00:00 bash
17073 pts/2    00:00:09 emacs
17133 pts/2    00:00:02 mozilla-bin
17140 pts/2    00:00:00 mozilla-bin
17141 pts/2    00:00:00 mozilla-bin
17142 pts/2    00:00:00 mozilla-bin
17144 pts/2    00:00:00 mozilla-bin
17146 pts/2    00:00:00 ps

$ ps | grep mozilla
    17133 pts/2    00:00:02 mozilla-bin
17140 pts/2    00:00:00 mozilla-bin
17141 pts/2    00:00:00 mozilla-bin
17142 pts/2    00:00:00 mozilla-bin
17144 pts/2    00:00:00 mozilla-bin

$ ps | grep mozilla | awk &#39;{ print $2 }&#39;
    17133
17140
17141
17142
17144

$ ps | grep mozilla | awk &#39;{ print $2 }&#39; | xargs kill -9
[2]+  Killed                  mozilla
</pre></div>
</div>
</div>
<div class="section" id="perl">
<h3><a class="toc-backref" href="#id18"><strong>perl</strong></a><a class="headerlink" href="#perl" title="Permalink to this headline">¶</a></h3>
<p><strong>Example 4-7. Text substitution with **perl**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ perl -pi -e &#39;s/old_pattern/new_pattern/g&#39; file.txt
$ perl -pi -e &#39;s/old_pattern/new_pattern/g&#39; $(find . -name \*.html)
</pre></div>
</div>
<p>The i option tells <strong>perl</strong> to do the global substitution in place.
You can also substitute the <strong>/</strong> with another character. For
example:</p>
<div class="highlight-python"><div class="highlight"><pre>$ perl -pi -e &#39;s:old_pattern:new_pattern:g&#39; file.txt
</pre></div>
</div>
<p><strong>Example 4-8. Summing columns with **perl**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ perl -lane &#39;print $F[0] + $F[1]&#39; file.txt       # sums column 1 and 2 of file.txt
</pre></div>
</div>
</div>
</div>
<div class="section" id="streams-pipes-and-redirects">
<h2><a class="toc-backref" href="#id19">Streams, Pipes, and Redirects</a><a class="headerlink" href="#streams-pipes-and-redirects" title="Permalink to this headline">¶</a></h2>
<p>UNIX programs that involve input and/or output often operate by reading
input from a stream known as standard input (<em>stdin</em>), and writing their
results to a stream known as standard output (<em>stdout</em>). In addition, a
third stream known as standard error (<em>stderr</em>) receives error messages,
and other information that’s not part of the program’s results. In the
usual interactive session, standard output and standard error default to
your screen, and standard input defaults to your keyboard. You can
change the place from which programs read and write through redirection.
The shell provides this service, not the individual programs, so
redirection will work for all programs. Table 3 shows some examples of
redirection.</p>
<div class="section" id="default-file-descriptors">
<h3><a class="toc-backref" href="#id20">Default File Descriptors</a><a class="headerlink" href="#default-file-descriptors" title="Permalink to this headline">¶</a></h3>
<p><strong>Table 3-1. File Descriptors</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="31%" />
<col width="38%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">I/O</th>
<th class="head">File Descriptor</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>stdin</td>
<td>input</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>stdout</td>
<td>output</td>
<td>1</td>
</tr>
<tr class="row-even"><td>stderr</td>
<td>error output</td>
<td>2</td>
</tr>
<tr class="row-odd"><td>user-defined</td>
<td>input/output</td>
<td>3-19</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="io-redirection">
<h3><a class="toc-backref" href="#id21">IO Redirection</a><a class="headerlink" href="#io-redirection" title="Permalink to this headline">¶</a></h3>
<p>Note that <em>cmd</em> may include options and arguments as seen in the
previous section.</p>
<p>Operations where output from one command is used as input to another
command (via the | operator) are known as pipes; they are made
especially useful by the convention that many UNIX commands will accept
their input through the standard input stream when no file name is
provided to them.</p>
<p>Here’s an example of finding out how many unique entries there are in
the 2rd column of a data file whose fields are separated by commas:</p>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">cut</span> <span class="pre">-d’,’</span> <span class="pre">-f2</span> <span class="pre">cpds.csv</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">|</span> <span class="pre">uniq</span> <span class="pre">|</span> <span class="pre">wc</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">cut</span> <span class="pre">-d’,’</span> <span class="pre">-f2</span> <span class="pre">cpds.csv</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">|</span> <span class="pre">uniq</span> <span class="pre">&gt;</span> <span class="pre">countries.txt</span></code></p>
<p>To see if there are any “S” values in certain fields (fixed width) of a
set of files (note I did this on 22,000 files (5 Gb or so) in about 5
minutes on my desktop; it would have taken much more time to read the
data into R):</p>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">cut</span> <span class="pre">-b29,37,45,53,61,69,77,85,93,101,109,117,125,133,141,149,</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">157,165,173,181,189,197,205,213,221,229,237,245,253,261,269</span> <span class="pre">USC*.dly</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">S</span> <span class="pre">|</span> <span class="pre">less</span></code></div>
</div>
<p>A closely related, but subtly different, capability is offered by the
use of backticks (`). When the shell encounters a command surrounded by
backticks, it runs the command and replaces the backticked expression
with the output from the command; this allows something similar to a
pipe, but is appropriate when a command reads its arguments directly
from the command line instead of through standard input. For example,
suppose we are interested in searching for the text <em>pdf</em> in the last 4
R code files (those with suffix <em>.</em>r or .R) that were modified in the
current directory. We can find the names of the last 4 files ending in
“.R” or “.r” which were modified using</p>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">ls</span> <span class="pre">-t</span> <span class="pre">*.{R,r}</span> <span class="pre">|</span> <span class="pre">head</span> <span class="pre">-4</span></code></div>
<div class="line">and we can search for the required pattern using <em>grep</em>. Putting these
together with the backtick operator we can solve the problem using</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">grep</span> <span class="pre">pdf</span> <span class="pre">`ls</span> <span class="pre">-t</span> <span class="pre">*.{R,r}</span> <span class="pre">|</span> <span class="pre">head</span> <span class="pre">-4`</span></code></div>
<div class="line">Note that piping the output of the <em>ls</em> command into <em>grep</em> would not
achieve the desired goal, since <em>grep</em> reads its filenames from the
command line, not standard input.</div>
</div>
<p>You can also redirect output as the arguments to another program using
the <em>xargs</em> utility. Here’s an example:</p>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">ls</span> <span class="pre">-t</span> <span class="pre">*.{R,r}</span> <span class="pre">|</span> <span class="pre">head</span> <span class="pre">-4</span> <span class="pre">|</span> <span class="pre">xargs</span> <span class="pre">grep</span> <span class="pre">pdf</span></code></p>
<p>And you can redirect output into a shell variable (see section 9) using
backticks in a similar manner to that done above:</p>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">files=ls</span> <span class="pre">-t</span> <span class="pre">*.{R,r}</span> <span class="pre">|</span> <span class="pre">head</span> <span class="pre">-4</span> <span class="pre">#</span> <span class="pre">NOTE</span> <span class="pre">-</span> <span class="pre">don’t</span> <span class="pre">put</span> <span class="pre">any</span> <span class="pre">spaces</span> <span class="pre">around</span> <span class="pre">the</span> <span class="pre">=</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">echo</span> <span class="pre">$files</span></code></p>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">grep</span> <span class="pre">pdf</span> <span class="pre">$files</span></code></p>
<p><strong>Table 3-2. Common Redirection Operators</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Redirection Syntax</th>
<th class="head">Function</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>$ cmd &gt; file</em></td>
<td>Send <em>stdout</em> to <em>file</em></td>
</tr>
<tr class="row-odd"><td><em>$ cmd 1&gt; file</em></td>
<td>Same as above</td>
</tr>
<tr class="row-even"><td><em>$ cmd 2&gt; file</em></td>
<td>Send <em>stderr</em> to <em>file</em></td>
</tr>
<tr class="row-odd"><td><em>$ cmd &gt; file 2&gt;&amp;1</em></td>
<td>Send both <em>stdout</em> and <em>stderr</em> to <em>file</em></td>
</tr>
<tr class="row-even"><td><em>$ cmd &lt; file</em></td>
<td>Receive <em>stdin</em> from <em>file</em></td>
</tr>
<tr class="row-odd"><td><em>$ cmd &gt;&gt; file</em></td>
<td>Append <em>stdout</em> to <em>file</em>:</td>
</tr>
<tr class="row-even"><td><em>$ cmd 1&gt;&gt; file</em></td>
<td>Same as above</td>
</tr>
<tr class="row-odd"><td><em>$ cmd 2&gt;&gt; file</em></td>
<td>Append <em>stderr</em> to <em>file</em></td>
</tr>
<tr class="row-even"><td><em>$ cmd &gt;&gt; file 2&gt;&amp;1</em></td>
<td>Append both <em>stdout</em> and <em>stderr</em> to <em>file</em></td>
</tr>
<tr class="row-odd"><td><em>$ cmd1 | cmd2</em></td>
<td>Pipe <em>stdout</em> from <em>cmd1</em> to <em>cmd2</em></td>
</tr>
<tr class="row-even"><td><em>$ cmd1 2&gt;&amp;1 | cmd2</em></td>
<td>Pipe <em>stdout</em> and <em>stderr</em> from <em>cmd1</em> to <em>cmd2</em></td>
</tr>
<tr class="row-odd"><td><em>$ cmd1 tee file1 | cmd2</em></td>
<td>Pipe <em>stdout</em> and <em>cmd1</em> to <em>cmd2</em> while
simultaneously writing it to <em>file1</em>
using <em>tee</em></td>
</tr>
</tbody>
</table>
<div class="section" id="standard-redirection">
<h4>Standard Redirection<a class="headerlink" href="#standard-redirection" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="pipes">
<h4>Pipes<a class="headerlink" href="#pipes" title="Permalink to this headline">¶</a></h4>
<p>Useful Contents</p>
<ul class="simple">
<li><a class="reference internal" href="../commands/wc.html#command-wc"><span>wc</span></a> &#8211;&nbsp; print the number of bytes, words, and lines in
files</li>
</ul>
<p><strong>Example 3-1. A simple pipe to **wc**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ echo &quot;hey there&quot; | wc -w
      2
</pre></div>
</div>
</div>
<div class="section" id="the-xargs-and-tee-command">
<h4>The <strong>xargs</strong> and <strong>tee</strong> Command<a class="headerlink" href="#the-xargs-and-tee-command" title="Permalink to this headline">¶</a></h4>
<p>Useful Contents</p>
<ul class="simple">
<li><a class="reference internal" href="../commands/xargs.html#command-xargs"><span>xargs</span></a> &#8211;&nbsp; build and execute command lines from
standard input</li>
<li><a class="reference internal" href="../commands/tee.html#command-tee"><span>tee</span></a> &#8211;&nbsp;read from standard input and write to standard
output and files</li>
</ul>
</div>
</div>
</div>
<div class="section" id="creating-monitoring-and-killing-processes">
<h2><a class="toc-backref" href="#id22">Creating, Monitoring, and Killing Processes</a><a class="headerlink" href="#creating-monitoring-and-killing-processes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="processes">
<h3><a class="toc-backref" href="#id23">Processes</a><a class="headerlink" href="#processes" title="Permalink to this headline">¶</a></h3>
<p>Processes have the following attributes:</p>
<ul class="simple">
<li>A lifetime.</li>
<li>A PID.</li>
<li>A UID.</li>
<li>A GID.</li>
<li>A parent process.</li>
<li>An environment.</li>
<li>A current working directory.</li>
</ul>
</div>
<div class="section" id="monitoring-processes">
<h3><a class="toc-backref" href="#id24">Monitoring Processes</a><a class="headerlink" href="#monitoring-processes" title="Permalink to this headline">¶</a></h3>
<p>Useful Contents</p>
<ul class="simple">
<li><a class="reference internal" href="../commands/ps.html#command-ps"><span>ps</span></a> &#8211;&nbsp; report process status</li>
<li><a class="reference internal" href="../commands/pstree.html#command-pstree"><span>pstree</span></a> &#8211;&nbsp;display a tree of processes</li>
<li><a class="reference internal" href="../commands/top.html#command-top"><span>top</span></a> &#8211;&nbsp;display top CPU processes</li>
</ul>
<p><strong>Example 3-2. Examining Processes with **ps**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ ps
  PID TTY          TIME CMD
29982 pts/1    00:00:00 bash
30042 pts/1    00:00:00 gvim
30162 pts/1    00:00:00 ps

$ ps -f
UID        PID  PPID  C STIME TTY          TIME CMD
user1   29982 29981  0 17:04 pts/1    00:00:00 /bin/bash
user1   30042 29982  0 17:05 pts/1    00:00:00 gvim manual.xml
user1   30161 29982  0 17:11 pts/1    00:00:00 ps -f

$ ps -lf
  F S UID        PID  PPID  C PRI  NI ADDR    SZ WCHAN  STIME TTY          TIME CMD
000 S user1   29982 29981  0  75   0    -   712 wait4  17:04 pts/1    00:00:00 /bin/bash
000 S user1   30042 29982  0  75   0    -  2849 schedu 17:05 pts/1    00:00:01 emacs manual.xml
000 R user1   30238 29982  0  76   0    -   855 -      17:16 pts/1    00:00:00 ps -lf
</pre></div>
</div>
<p><strong>Example 3-3. Examining Processes with **pstree**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ pstree
init-+-alarmd
     |-atd
     |-bdflush
     |-crond
     |-cupsd
     |-gkrellm
     |-gpm
     |-7*[kdeinit]
     |-kdeinit-+-kdeinit
     |         |-konsole---bash-+-emacs
     |         |                `-pstree
     |         `-soundwrapper---mozilla-bin---mozilla-bin---4*[mozilla-bin]
     |-kdeinit---cat
     |-kdm-+-X
     |     `-kdm---startkde-+-ksmserver
     |                      `-ssh-agent
     |-sshd
     |-syslogd
     |-xfs
     |-xinetd
     `-ypbind---ypbind
</pre></div>
</div>
<p><strong>Example 3-4. Examining Processes with **top**</strong></p>
<div class="highlight-python"><div class="highlight"><pre>$ top
  5:18pm  up 2 days, 13:26,  2 users,  load average: 0.03, 0.03, 0.00
76 processes: 75 sleeping, 1 running, 0 zombie, 0 stopped
CPU0 states:  0.4% user,  0.3% system,  0.0% nice, 98.3% idle
CPU1 states:  0.0% user,  0.4% system,  0.0% nice, 99.1% idle
Mem:  2068644K av, 1001668K used, 1066976K free,       0K shrd,  218192K buff
Swap:  401584K av,       0K used,  401584K free                  339532K cached

  PID USER     PRI  NI  SIZE  RSS SHARE STAT %CPU %MEM   TIME COMMAND
 1840 root       5 -10  284M  28M  4340 S &lt;   0.9  1.4  10:24 X
29981 user1    15   0 13504  13M  8120 S     0.7  0.6   0:01 konsole
30296 user1    15   0  1188 1188   928 R     0.3  0.0   0:00 top
    1 root      15   0   504  504   440 S     0.0  0.0   0:05 init
</pre></div>
</div>
</div>
<div class="section" id="signaling-processes">
<h3><a class="toc-backref" href="#id25">Signaling Processes</a><a class="headerlink" href="#signaling-processes" title="Permalink to this headline">¶</a></h3>
<p>Useful Contents</p>
<ul class="simple">
<li><a class="reference internal" href="../commands/kill.html#command-kill"><span>kill</span></a> &#8211;&nbsp;terminate a process</li>
<li><a class="reference internal" href="../commands/killall.html#command-killall"><span>killall</span></a> &#8211;&nbsp; kill processes by name</li>
</ul>
<p><strong>Table 3-3. Common Signals</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="66%" />
<col width="8%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Signal Number</th>
<th class="head">Meaning</th>
<th class="head">HUP</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>Hangup, reread configuration</td>
<td>INT</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>Interrupt, stop running</td>
<td>KILL</td>
</tr>
<tr class="row-even"><td>9</td>
<td>Stop immediately</td>
<td>TERM</td>
</tr>
<tr class="row-odd"><td>15</td>
<td>Terminate nicely</td>
<td>TSTP</td>
</tr>
<tr class="row-even"><td>18</td>
<td>Stop executing, ready to continue</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="shell-job-control">
<h3><a class="toc-backref" href="#id26">Shell Job Control</a><a class="headerlink" href="#shell-job-control" title="Permalink to this headline">¶</a></h3>
<p>Useful Contents</p>
<ul class="simple">
<li><a class="reference internal" href="../commands/bg.html#command-bg"><span>bg</span></a> &#8211;&nbsp;background</li>
<li><a class="reference internal" href="../commands/fg.html#command-fg"><span>fg</span></a> &#8211;&nbsp;foreground</li>
<li><a class="reference internal" href="../commands/jobs.html#command-jobs"><span>jobs</span></a> &#8211;&nbsp;list the active jobs</li>
<li><a class="reference internal" href="../commands/nohup.html#command-nohup"><span>nohup</span></a> &#8211;&nbsp;Run a command immune to hangups, with
output to a non-tty</li>
</ul>
<div class="section" id="starting-a-job">
<h4>Starting a job<a class="headerlink" href="#starting-a-job" title="Permalink to this headline">¶</a></h4>
<p>When you run a command in a shell by simply typing its name, you are
said to be running in the foreground. When a job is running in the
foreground, you can’t type additional commands into that shell session,
but there are two signals that can be sent to the running job through
the keyboard. To interrupt a program running in the foreground, use
<code class="docutils literal"><span class="pre">C-c</span></code>; to quit a program, use <code class="docutils literal"><span class="pre">C-\</span></code>. While modern windowed systems
have lessened the inconvenience of tying up a shell with foreground
processes, there are some situations where running in the foreground is
not adequate.</p>
<p>The primary need for an alternative to foreground processing arises when
you wish to have jobs continue to run after you log off the computer. In
cases like this you can run a program in the background by simply
terminating the command with an ampersand (<em>&amp;</em>). However, before putting
a job in the background, you should consider how you will access its
results, since <em>stdout</em> is not preserved when you log off from the
computer. Thus, redirection (including redirection of <em>stderr</em>) is
essential when running jobs in the background. As a simple example,
suppose that you wish to run an R script, and you don’t want it to
terminate when you log off. (Note that this can also be done using
<code class="docutils literal"><span class="pre">R</span> <span class="pre">CMD</span> <span class="pre">BATCH</span></code>, so this is primarily an illustration.)</p>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">R</span> <span class="pre">--no-save</span> <span class="pre">&lt;</span> <span class="pre">code.R</span> <span class="pre">&gt;</span> <span class="pre">code.Rout</span> <span class="pre">2&gt;&amp;1</span> <span class="pre">&amp;</span></code></div>
<div class="line">If you forget to put a job in the background when you first execute
it, you can do it while it’s running in the foreground in two steps.
First, suspend the job using the <code class="docutils literal"><span class="pre">C-z</span></code> signal. After receiving the
signal, the program will interrupt execution, but will still have
access to all files and other resources. Next, issue the <code class="docutils literal"><span class="pre">bg</span></code>
command, which will put the stopped job in the background.</div>
</div>
</div>
<div class="section" id="listing-and-killing-jobs">
<h4>Listing and killing jobs<a class="headerlink" href="#listing-and-killing-jobs" title="Permalink to this headline">¶</a></h4>
<p>Since only foreground jobs will accept signals through the keyboard, if
you want to terminate a background job you must first determine the
unique process id (PID) for the process you wish to terminate through
the use of the <em>ps</em> command. For example, to see all the jobs running on
a particular computer, you could use a command like:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; ps -aux
</pre></div>
</div>
<p>Among the output after the header (shown here) might appear a line
that looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre>USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND
paciorek 11998 97.0 39.1 1416644 1204824 pts/16 R+ Jul27 1330:01 /usr/lib64/R/bin/exec/R
</pre></div>
</div>
<p>In this example, the <em>ps</em> output tells us that this R job has a PID of
<em>11998</em>, that it has been running for 1330 minutes (!), is using 97%
of CPU and 39% of memory, and that it started on July 27. You could
then issue the command:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; kill 11998
</pre></div>
</div>
<p>or, if that doesn’t work:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; kill -9 11998
</pre></div>
</div>
<p>to terminate the job. Another useful command in this regard is
<em>killall</em>, which accepts a program name instead of a process id, and
will kill all instances of the named program:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; killall R
</pre></div>
</div>
<p>Of course, it will only kill the jobs that belong to you, so it will
not affect the jobs of other users. Note that the <em>ps</em> and <em>kill</em>
commands only apply to the particular computer on which they are
executed, not to the entire computer network. Thus, if you start a job
on one machine, you must log back into that same machine in order to
manage your job.</p>
</div>
<div class="section" id="monitoring-jobs-and-memory-use">
<h4>Monitoring jobs and memory use<a class="headerlink" href="#monitoring-jobs-and-memory-use" title="Permalink to this headline">¶</a></h4>
<p>The <em>top</em> command also allows you to monitor the jobs on the system and
in real-time. In particular, it’s useful for seeing how much of the CPU
and how much memory is being used, as well as figuring out a PID as an
alternative to <em>ps</em>. You can also renice jobs (see below) and kill jobs
from within top: just type <em>r</em> or <em>k</em>, respectively, and proceed
from there.</p>
<p>One of the main things to watch out for is a job that is using close to
100% of memory and much less than 100% of CPU. What is generally
happening is that your program has run out of memory and is using
virtual memory on disk, spending most of its time writing to/from disk,
sometimes called <em>paging</em> or <em>swapping</em>. If this happens, it can be a
very long time, if ever, before your job finishes.</p>
</div>
<div class="section" id="nicing-a-job">
<h4>Nicing a job<a class="headerlink" href="#nicing-a-job" title="Permalink to this headline">¶</a></h4>
<p>The most important thing to remember when starting a job on a machine
that is not your personal machine is how to be a good citizen. This
often involves ’nicing’ your jobs. This is required on the SCF machines,
but the compute servers should automatically nice your jobs. Nicing a
job puts it at a lower priority so that a user working at the keyboard
has higher priority in using the CPU. Here’s how to do it, giving the
job a low priority of 19, as required by SCF:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; nice -19 R CMD BATCH --no-save code.R code.Rout &amp;
</pre></div>
</div>
<p>If you forget and just submit the job without nicing, you can reduce
the priority by doing:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; renice +19 11998
</pre></div>
</div>
<p>where <em>11998</em> is the PID of your job.</p>
<p>On many larger UNIX cluster computers, all jobs are submitted via a job
scheduler and enter a queue, which handles the issue of prioritization
and jobs conflicting. Syntax varies by system and queueing software, but
may look something like this for submitting an R job:</p>
<p><code class="docutils literal"><span class="pre">&gt;</span> <span class="pre">bsub</span> <span class="pre">-q</span> <span class="pre">long</span> <span class="pre">R</span> <span class="pre">CMD</span> <span class="pre">BATCH</span> <span class="pre">--no-save</span> <span class="pre">code.R</span> <span class="pre">code.Rout</span> <span class="pre">#</span> <span class="pre">just</span> <span class="pre">an</span> <span class="pre">example;</span> <span class="pre">this</span> <span class="pre">will</span> <span class="pre">not</span> <span class="pre">work</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">SCF</span> <span class="pre">network</span></code></p>
<p>bg,fg,jobs,Ctrl-C,Ctrl-Z</p>
<p><strong>screen</strong></p>
</div>
</div>
</div>
<div class="section" id="shell-programming">
<h2><a class="toc-backref" href="#id27">Shell programming</a><a class="headerlink" href="#shell-programming" title="Permalink to this headline">¶</a></h2>
<p>Shell commands can be saved in a file (with extension <em>.sh</em>) and this
file can be executed as if it were a program. To run a shell script
called <em>file.sh</em>, you would type <code class="docutils literal"><span class="pre">./file.sh</span></code>. Note that if you just
typed`` file.sh``, the operating system will generally have trouble
finding the script and recognizing that it is executable. To be sure
that the operating system knows what shell to use to interpret the
script, the first line of the script should be <code class="docutils literal"><span class="pre">#!/bin/bash</span></code> (in the
case that you’re using the bash shell). Also, <em>file.sh</em> would need to be
executable (i.e., to have the ’x’ flag set).</p>
<div class="section" id="functions">
<h3><a class="toc-backref" href="#id28">Functions</a><a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<p>You can define your own utilities by creating a shell function. This
allows you to automate things that are more complicated than you can do
with an alias. One nice thing about shell functions is that the shell
automatically takes care of function arguments for you. It places the
arguments given by the user into local variables in the function called
(in order): <em>$1 $2 $3</em> etc. It also fills <em>$#</em> with the number of
arguments given by the user. Here’s an example of using arguments in a
function that saves me some typing when I want to copy a file to the SCF
filesystem:</p>
<div class="highlight-python"><div class="highlight"><pre>function putscf() {
   scp $1 paciorek@radagast.berkeley.edu:~/$2 ``
}
</pre></div>
</div>
<p>To use this function, I just do the following to copy <em>unit1.pdf</em> from
the current directory on whatever non-SCF machine I’m on to the
directory <em>~/teaching/243</em> on SCF:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; putscf unit1-unix.pdf Desktop/.
</pre></div>
</div>
<p>Of course you’d want to put such functions in your <em>.bashrc</em> file.</p>
</div>
<div class="section" id="if-then-else">
<h3><a class="toc-backref" href="#id29">If/then/else</a><a class="headerlink" href="#if-then-else" title="Permalink to this headline">¶</a></h3>
<p>We can use if-then-else type syntax to control the flow of a shell
script. For an example, see <em>niceR()</em> in the demo code file <em>niceR.sh</em>
for this unit.</p>
<p>For more details, look in Newham&amp;Rosenblatt or search online.</p>
</div>
<div class="section" id="for-loops">
<h3><a class="toc-backref" href="#id30">For loops</a><a class="headerlink" href="#for-loops" title="Permalink to this headline">¶</a></h3>
<p><em>for</em> loops in shell scripting are primarily designed for iterating
through a set of files or directories. Here’s an example:</p>
<div class="highlight-python"><div class="highlight"><pre>for file in $(ls *.txt)
do
   mv $file ${file/.txt/.R}
   # this syntax replaces .txt with .R in $file``
done
</pre></div>
</div>
<p>You could also have done that with <code class="docutils literal"><span class="pre">for</span> <span class="pre">file</span> <span class="pre">in</span> <span class="pre">`ls</span> <span class="pre">*.txt`</span></code></p>
<p>Another use of <em>for</em> loops is automating file downloads: see the demo
code file. And, in my experience, <em>for</em> loops are very useful for
starting a series of jobs: see the demo code files in the repository:
<em>forloopDownload.sh</em> and <em>forloopJobs.sh</em>.</p>
</div>
<div class="section" id="how-much-shell-scripting-should-i-learn">
<h3><a class="toc-backref" href="#id31">How much shell scripting should I learn?</a><a class="headerlink" href="#how-much-shell-scripting-should-i-learn" title="Permalink to this headline">¶</a></h3>
<p>You can do a fair amount of what you need from within R using the
<em>system()</em> function. This will enable you to avoid dealing with a lot of
shell programming syntax (but you’ll still need to know how to use UNIX
utilities, wildcards, and pipes to be effective). Example: a fellow
student when I was in grad school programmed a tool in R to extract
concert information from the web for bands appearing in her iTunes
library. Not the most elegant solution, but it got the job done.</p>
<p>For more extensive shell programming, it’s probably worth learning
Python and doing it there rather than using a shell script. In
particular iPython makes it very easy to interact with the operating
system.</p>
</div>
</div>
<div class="section" id="documentation-tools">
<h2><a class="toc-backref" href="#id32">Documentation tools</a><a class="headerlink" href="#documentation-tools" title="Permalink to this headline">¶</a></h2>
<p><strong>markdown</strong>, <strong>restructured text</strong>, latex</p>
<p><strong>pandoc</strong></p>
<p>Please see the &#8220;Introduction to LaTeX&#8221; tutorial and screencast
here: <a class="reference external" href="http://statistics.berkeley.edu/computing/training/tutorials">http://statistics.berkeley.edu/computing/training/tutorials</a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">RCSDS</a></h1>



<p class="blurb">Fall 2015</p>




<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Standard Topics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="course-intro.html">Course introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="git-intro.html">Git introduction</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Advanced Bash</a></li>
<li class="toctree-l2"><a class="reference internal" href="fmri-intro.html">Statistical analysis of fMRI data</a></li>
<li class="toctree-l2"><a class="reference internal" href="python.html">Python introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="numpy.html">Scientific computing with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="git-advanced.html">Collaborative workflow with Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="eda.html">Exploratory data analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="organize-automate.html">Project organization and process automation</a></li>
<li class="toctree-l2"><a class="reference internal" href="statistics.html">Statistics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../append/index.html">Appendices</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="http://www.jarrodmillman.com/stat159-fall2015/">Course home</a></li>
    
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
      &copy;2009-2015, K. Jarrod Millman, Christopher Paciorek.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
      |
      <a href="_sources/index.txt"
          rel="nofollow">Page source</a>
        <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution 4.0 International License</a>, except where indicated otherwise.
</small></p>
    </div>

  </body>
</html>